---
# ----------------------------------------------------------------------------
#
#     ***     AUTO GENERATED CODE    ***    Type: MMv1     ***
#
# ----------------------------------------------------------------------------
#
#     This code is generated by Magic Modules using the following:
#
#     Configuration: https:#github.com/GoogleCloudPlatform/magic-modules/tree/main/mmv1/products/cloudsecuritycompliance/CloudControl.yaml
#     Template:      https:#github.com/GoogleCloudPlatform/magic-modules/tree/main/mmv1/templates/terraform/resource.html.markdown.tmpl
#
#     DO NOT EDIT this file directly. Any changes made to this file will be
#     overwritten during the next generation cycle.
#
# ----------------------------------------------------------------------------
subcategory: "Cloud Security Compliance"
description: |-
  Cloud controls are the building blocks that make up frameworks.
---

# google_cloud_security_compliance_cloud_control

Cloud controls are the building blocks that make up frameworks. Each cloud control is a unit encapsulating various platform-specific logic for prevention, detection, and audit.


To get more information about CloudControl, see:

* [API documentation](https://docs.cloud.google.com/security-command-center/docs/reference/cloudsecuritycompliance/rest/v1/organizations.locations.cloudControls)

## Example Usage - Cloudsecuritycompliance Cloudcontrol Basic


```hcl
resource "google_cloud_security_compliance_cloud_control" "example" {
  organization        = "123456789"
  location            = "global"
  cloud_control_id    = "example-cloudcontrol"

  display_name      = "TF test CloudControl Name"
  description       = "A test cloud control for security compliance"
  categories        = ["CC_CATEGORY_INFRASTRUCTURE"]
  severity          = "HIGH"
  finding_category  = "SECURITY_POLICY"
  remediation_steps = "Review and update the security configuration according to best practices."
  
  supported_cloud_providers        = ["GCP"]
  
  rules {
    description         = "Ensure compute instances have secure boot enabled"
    rule_action_types   = ["RULE_ACTION_TYPE_DETECTIVE"]
    
    cel_expression {
      expression = "resource.data.shieldedInstanceConfig.enableSecureBoot == true"
      resource_types_values {
        values = ["compute.googleapis.com/Instance"]
      }
    }
  }

  parameter_spec {
    name         = "location"
    display_name = "Resource Location"
    description  = "The location where the resource should be deployed"
    value_type   = "STRING"
    is_required  = true
    
    default_value {
      string_value = "us-central1"
    }
    
    validation {
      regexp_pattern {
        pattern = "^[a-z]+-[a-z]+[0-9]$"
      }
    }
  }

  parameter_spec {
    name         = "enable_secure_boot"
    display_name = "Enable Secure Boot"
    description  = "Whether to enable secure boot for instances"
    value_type   = "BOOLEAN"
    is_required  = true
    
    default_value {
      bool_value = true
    }
    
    substitution_rules {
      attribute_substitution_rule {
        attribute = "rules[0].cel_expression.expression"
      }
    }
    
    validation {
      allowed_values {
        values {
          bool_value = true
        }
      }
    }
  }

  parameter_spec {
    name         = "max_instances"
    display_name = "Maximum Instances"
    description  = "Maximum number of instances allowed"
    value_type   = "NUMBER"
    is_required  = false
    
    default_value {
      number_value = 10
    }
    
    substitution_rules {
      placeholder_substitution_rule {
        attribute = "rules[0].description"
      }
    }
    
    validation {
      int_range {
        min = "1"
        max = "100"
      }
    }
  }

  parameter_spec {
    name         = "allowed_regions"
    display_name = "Allowed Regions"
    description  = "List of regions where resources can be deployed"
    value_type   = "STRINGLIST"
    is_required  = true
    
    default_value {
      string_list_value {
        values = ["us-central1", "us-east1", "us-west1"]
      }
    }
    
    validation {
      allowed_values {
        values {
          string_list_value {
            values = ["us-central1", "us-east1"]
          }
        }
        values {
          string_list_value {
            values = ["us-west1", "us-west2"]
          }
        }
      }
    }
  }

  parameter_spec {
    name         = "environment_type"
    display_name = "Environment Type"
    description  = "The type of environment"
    value_type   = "STRING"
    is_required  = true
    
    default_value {
      string_value = "production"
    }
    
    validation {
      allowed_values {
        values {
          string_value = "production"
        }
        values {
          string_value = "staging"
        }
        values {
          number_value = 1
        }
      }
    }
  }
}
```

## Argument Reference

The following arguments are supported:


* `organization` -
  (Required)
  Resource ID segment making up resource `name`. It identifies the resource within its parent collection as described in https://google.aip.dev/122.

* `location` -
  (Required)
  Resource ID segment making up resource `name`. It identifies the resource within its parent collection as described in https://google.aip.dev/122. Currently, only "global" is supported as a location.

* `cloud_control_id` -
  (Required)
  ID of the CloudControl.
  This is the last segment of the CloudControl resource name.
  Format: `^a-zA-Z{0,61}[a-zA-Z0-9]$`.


* `categories` -
  (Optional)
  The categories of the cloud control.

* `description` -
  (Optional)
  A description of the cloud control. The maximum length is 2000 characters.

* `display_name` -
  (Optional)
  The display name of the cloud control. The maximum length is 200
  characters.

* `finding_category` -
  (Optional)
  The finding_category of the cloud control. The maximum length is 255
  characters.

* `parameter_spec` -
  (Optional)
  The parameter spec of the cloud control.
  Structure is [documented below](#nested_parameter_spec).

* `remediation_steps` -
  (Optional)
  The remediation steps for the findings generated by the cloud control. The
  maximum length is 400 characters.

* `rules` -
  (Optional)
  The Policy to be enforced to prevent/detect resource non-compliance.
  Structure is [documented below](#nested_rules).

* `severity` -
  (Optional)
  Possible values:
  CRITICAL
  HIGH
  MEDIUM
  LOW

* `supported_cloud_providers` -
  (Optional)
  cloud providers supported



<a name="nested_parameter_spec"></a>The `parameter_spec` block supports:

* `default_value` -
  (Optional)
  Possible parameter value types.
  Structure is [documented below](#nested_parameter_spec_default_value).

* `description` -
  (Optional)
  The description of the parameter. The maximum length is 2000 characters.

* `display_name` -
  (Optional)
  The display name of the parameter. The maximum length is 200 characters.

* `is_required` -
  (Required)
  if the parameter is required

* `name` -
  (Required)
  The name of the parameter.

* `substitution_rules` -
  (Optional)
  List of parameter substitutions.
  Structure is [documented below](#nested_parameter_spec_substitution_rules).

* `sub_parameters` -
  (Optional)
  The parameter spec of the cloud control.
  Structure is [documented below](#nested_parameter_spec_sub_parameters).

* `validation` -
  (Optional)
  Validation of the parameter.
  Structure is [documented below](#nested_parameter_spec_validation).

* `value_type` -
  (Required)
  Parameter value type.
  Possible values:
  STRING
  BOOLEAN
  STRINGLIST
  NUMBER
  ONEOF


<a name="nested_parameter_spec_default_value"></a>The `default_value` block supports:

* `bool_value` -
  (Optional)
  Represents a boolean value.

* `number_value` -
  (Optional)
  Represents a double value.

* `oneof_value` -
  (Optional)
  Sub-parameter values.
  Structure is [documented below](#nested_parameter_spec_default_value_oneof_value).

* `string_list_value` -
  (Optional)
  A list of strings.
  Structure is [documented below](#nested_parameter_spec_default_value_string_list_value).

* `string_value` -
  (Optional)
  Represents a string value.


<a name="nested_parameter_spec_default_value_oneof_value"></a>The `oneof_value` block supports:

* `name` -
  (Optional)
  The name of the parameter.

* `parameter_value` -
  (Optional)
  The value of the parameter.
  Structure is [documented below](#nested_parameter_spec_default_value_oneof_value_parameter_value).


<a name="nested_parameter_spec_default_value_oneof_value_parameter_value"></a>The `parameter_value` block supports:

* `bool_value` -
  (Optional)
  Represents a boolean value.

* `number_value` -
  (Optional)
  Represents a double value.

* `string_list_value` -
  (Optional)
  A list of strings.
  Structure is [documented below](#nested_parameter_spec_default_value_oneof_value_parameter_value_string_list_value).

* `string_value` -
  (Optional)
  Represents a string value.


<a name="nested_parameter_spec_default_value_oneof_value_parameter_value_string_list_value"></a>The `string_list_value` block supports:

* `values` -
  (Required)
  The strings in the list.

<a name="nested_parameter_spec_default_value_string_list_value"></a>The `string_list_value` block supports:

* `values` -
  (Required)
  The strings in the list.

<a name="nested_parameter_spec_substitution_rules"></a>The `substitution_rules` block supports:

* `attribute_substitution_rule` -
  (Optional)
  Attribute at the given path is substituted entirely.
  Structure is [documented below](#nested_parameter_spec_substitution_rules_attribute_substitution_rule).

* `placeholder_substitution_rule` -
  (Optional)
  Placeholder is substituted in the rendered string.
  Structure is [documented below](#nested_parameter_spec_substitution_rules_placeholder_substitution_rule).


<a name="nested_parameter_spec_substitution_rules_attribute_substitution_rule"></a>The `attribute_substitution_rule` block supports:

* `attribute` -
  (Optional)
  Fully qualified proto attribute path (in dot notation).
  Example: rules[0].cel_expression.resource_types_values

<a name="nested_parameter_spec_substitution_rules_placeholder_substitution_rule"></a>The `placeholder_substitution_rule` block supports:

* `attribute` -
  (Optional)
  Fully qualified proto attribute path (e.g., dot notation)

<a name="nested_parameter_spec_sub_parameters"></a>The `sub_parameters` block supports:

* `default_value` -
  (Optional)
  Possible parameter value types.
  Structure is [documented below](#nested_parameter_spec_sub_parameters_default_value).

* `description` -
  (Optional)
  The description of the parameter. The maximum length is 2000 characters.

* `display_name` -
  (Optional)
  The display name of the parameter. The maximum length is 200 characters.

* `is_required` -
  (Required)
  if the parameter is required

* `name` -
  (Required)
  The name of the parameter.

* `substitution_rules` -
  (Optional)
  List of parameter substitutions.
  Structure is [documented below](#nested_parameter_spec_sub_parameters_substitution_rules).

* `validation` -
  (Optional)
  Validation of the parameter.
  Structure is [documented below](#nested_parameter_spec_sub_parameters_validation).

* `value_type` -
  (Required)
  Parameter value type.
  Possible values:
  STRING
  BOOLEAN
  STRINGLIST
  NUMBER
  ONEOF


<a name="nested_parameter_spec_sub_parameters_default_value"></a>The `default_value` block supports:

* `bool_value` -
  (Optional)
  Represents a boolean value.

* `number_value` -
  (Optional)
  Represents a double value.

* `oneof_value` -
  (Optional)
  Sub-parameter values.
  Structure is [documented below](#nested_parameter_spec_sub_parameters_default_value_oneof_value).

* `string_list_value` -
  (Optional)
  A list of strings.
  Structure is [documented below](#nested_parameter_spec_sub_parameters_default_value_string_list_value).

* `string_value` -
  (Optional)
  Represents a string value.


<a name="nested_parameter_spec_sub_parameters_default_value_oneof_value"></a>The `oneof_value` block supports:

* `name` -
  (Optional)
  The name of the parameter.

* `parameter_value` -
  (Optional)
  The value of the parameter.
  Structure is [documented below](#nested_parameter_spec_sub_parameters_default_value_oneof_value_parameter_value).


<a name="nested_parameter_spec_sub_parameters_default_value_oneof_value_parameter_value"></a>The `parameter_value` block supports:

* `bool_value` -
  (Optional)
  Represents a boolean value.

* `number_value` -
  (Optional)
  Represents a double value.

* `string_list_value` -
  (Optional)
  A list of strings.
  Structure is [documented below](#nested_parameter_spec_sub_parameters_default_value_oneof_value_parameter_value_string_list_value).

* `string_value` -
  (Optional)
  Represents a string value.


<a name="nested_parameter_spec_sub_parameters_default_value_oneof_value_parameter_value_string_list_value"></a>The `string_list_value` block supports:

* `values` -
  (Required)
  The strings in the list.

<a name="nested_parameter_spec_sub_parameters_default_value_string_list_value"></a>The `string_list_value` block supports:

* `values` -
  (Required)
  The strings in the list.

<a name="nested_parameter_spec_sub_parameters_substitution_rules"></a>The `substitution_rules` block supports:

* `attribute_substitution_rule` -
  (Optional)
  Attribute at the given path is substituted entirely.
  Structure is [documented below](#nested_parameter_spec_sub_parameters_substitution_rules_attribute_substitution_rule).

* `placeholder_substitution_rule` -
  (Optional)
  Placeholder is substituted in the rendered string.
  Structure is [documented below](#nested_parameter_spec_sub_parameters_substitution_rules_placeholder_substitution_rule).


<a name="nested_parameter_spec_sub_parameters_substitution_rules_attribute_substitution_rule"></a>The `attribute_substitution_rule` block supports:

* `attribute` -
  (Optional)
  Fully qualified proto attribute path (in dot notation).
  Example: rules[0].cel_expression.resource_types_values

<a name="nested_parameter_spec_sub_parameters_substitution_rules_placeholder_substitution_rule"></a>The `placeholder_substitution_rule` block supports:

* `attribute` -
  (Optional)
  Fully qualified proto attribute path (e.g., dot notation)

<a name="nested_parameter_spec_sub_parameters_validation"></a>The `validation` block supports:

* `allowed_values` -
  (Optional)
  Allowed set of values for the parameter.
  Structure is [documented below](#nested_parameter_spec_sub_parameters_validation_allowed_values).

* `int_range` -
  (Optional)
  Number range for number parameters.
  Structure is [documented below](#nested_parameter_spec_sub_parameters_validation_int_range).

* `regexp_pattern` -
  (Optional)
  Regular Expression Validator for parameter values.
  Structure is [documented below](#nested_parameter_spec_sub_parameters_validation_regexp_pattern).


<a name="nested_parameter_spec_sub_parameters_validation_allowed_values"></a>The `allowed_values` block supports:

* `values` -
  (Required)
  List of allowed values for the parameter.
  Structure is [documented below](#nested_parameter_spec_sub_parameters_validation_allowed_values_values).


<a name="nested_parameter_spec_sub_parameters_validation_allowed_values_values"></a>The `values` block supports:

* `bool_value` -
  (Optional)
  Represents a boolean value.

* `number_value` -
  (Optional)
  Represents a double value.

* `oneof_value` -
  (Optional)
  Sub-parameter values.
  Structure is [documented below](#nested_parameter_spec_sub_parameters_validation_allowed_values_values_oneof_value).

* `string_list_value` -
  (Optional)
  A list of strings.
  Structure is [documented below](#nested_parameter_spec_sub_parameters_validation_allowed_values_values_string_list_value).

* `string_value` -
  (Optional)
  Represents a string value.


<a name="nested_parameter_spec_sub_parameters_validation_allowed_values_values_oneof_value"></a>The `oneof_value` block supports:

* `name` -
  (Optional)
  The name of the parameter.

* `parameter_value` -
  (Optional)
  The value of the parameter.
  Structure is [documented below](#nested_parameter_spec_sub_parameters_validation_allowed_values_values_oneof_value_parameter_value).


<a name="nested_parameter_spec_sub_parameters_validation_allowed_values_values_oneof_value_parameter_value"></a>The `parameter_value` block supports:

* `bool_value` -
  (Optional)
  Represents a boolean value.

* `number_value` -
  (Optional)
  Represents a double value.

* `string_list_value` -
  (Optional)
  A list of strings.
  Structure is [documented below](#nested_parameter_spec_sub_parameters_validation_allowed_values_values_oneof_value_parameter_value_string_list_value).

* `string_value` -
  (Optional)
  Represents a string value.


<a name="nested_parameter_spec_sub_parameters_validation_allowed_values_values_oneof_value_parameter_value_string_list_value"></a>The `string_list_value` block supports:

* `values` -
  (Required)
  The strings in the list.

<a name="nested_parameter_spec_sub_parameters_validation_allowed_values_values_string_list_value"></a>The `string_list_value` block supports:

* `values` -
  (Required)
  The strings in the list.

<a name="nested_parameter_spec_sub_parameters_validation_int_range"></a>The `int_range` block supports:

* `max` -
  (Required)
  Maximum allowed value for the numeric parameter (inclusive).

* `min` -
  (Required)
  Minimum allowed value for the numeric parameter (inclusive).

<a name="nested_parameter_spec_sub_parameters_validation_regexp_pattern"></a>The `regexp_pattern` block supports:

* `pattern` -
  (Required)
  Regex Pattern to match the value(s) of parameter.

<a name="nested_parameter_spec_validation"></a>The `validation` block supports:

* `allowed_values` -
  (Optional)
  Allowed set of values for the parameter.
  Structure is [documented below](#nested_parameter_spec_validation_allowed_values).

* `int_range` -
  (Optional)
  Number range for number parameters.
  Structure is [documented below](#nested_parameter_spec_validation_int_range).

* `regexp_pattern` -
  (Optional)
  Regular Expression Validator for parameter values.
  Structure is [documented below](#nested_parameter_spec_validation_regexp_pattern).


<a name="nested_parameter_spec_validation_allowed_values"></a>The `allowed_values` block supports:

* `values` -
  (Required)
  List of allowed values for the parameter.
  Structure is [documented below](#nested_parameter_spec_validation_allowed_values_values).


<a name="nested_parameter_spec_validation_allowed_values_values"></a>The `values` block supports:

* `bool_value` -
  (Optional)
  Represents a boolean value.

* `number_value` -
  (Optional)
  Represents a double value.

* `oneof_value` -
  (Optional)
  Sub-parameter values.
  Structure is [documented below](#nested_parameter_spec_validation_allowed_values_values_oneof_value).

* `string_list_value` -
  (Optional)
  A list of strings.
  Structure is [documented below](#nested_parameter_spec_validation_allowed_values_values_string_list_value).

* `string_value` -
  (Optional)
  Represents a string value.


<a name="nested_parameter_spec_validation_allowed_values_values_oneof_value"></a>The `oneof_value` block supports:

* `name` -
  (Optional)
  The name of the parameter.

* `parameter_value` -
  (Optional)
  The value of the parameter.
  Structure is [documented below](#nested_parameter_spec_validation_allowed_values_values_oneof_value_parameter_value).


<a name="nested_parameter_spec_validation_allowed_values_values_oneof_value_parameter_value"></a>The `parameter_value` block supports:

* `bool_value` -
  (Optional)
  Represents a boolean value.

* `number_value` -
  (Optional)
  Represents a double value.

* `string_list_value` -
  (Optional)
  A list of strings.
  Structure is [documented below](#nested_parameter_spec_validation_allowed_values_values_oneof_value_parameter_value_string_list_value).

* `string_value` -
  (Optional)
  Represents a string value.


<a name="nested_parameter_spec_validation_allowed_values_values_oneof_value_parameter_value_string_list_value"></a>The `string_list_value` block supports:

* `values` -
  (Required)
  The strings in the list.

<a name="nested_parameter_spec_validation_allowed_values_values_string_list_value"></a>The `string_list_value` block supports:

* `values` -
  (Required)
  The strings in the list.

<a name="nested_parameter_spec_validation_int_range"></a>The `int_range` block supports:

* `max` -
  (Required)
  Maximum allowed value for the numeric parameter (inclusive).

* `min` -
  (Required)
  Minimum allowed value for the numeric parameter (inclusive).

<a name="nested_parameter_spec_validation_regexp_pattern"></a>The `regexp_pattern` block supports:

* `pattern` -
  (Required)
  Regex Pattern to match the value(s) of parameter.

<a name="nested_rules"></a>The `rules` block supports:

* `cel_expression` -
  (Optional)
  A [CEL
  expression](https://cloud.google.com/certificate-authority-service/docs/using-cel).
  Structure is [documented below](#nested_rules_cel_expression).

* `description` -
  (Optional)
  Description of the Rule. The maximum length is 2000 characters.

* `rule_action_types` -
  (Required)
  The functionality enabled by the Rule.


<a name="nested_rules_cel_expression"></a>The `cel_expression` block supports:

* `expression` -
  (Required)
  Logic expression in CEL language.
  The max length of the condition is 1000 characters.

* `resource_types_values` -
  (Optional)
  A list of strings.
  Structure is [documented below](#nested_rules_cel_expression_resource_types_values).


<a name="nested_rules_cel_expression_resource_types_values"></a>The `resource_types_values` block supports:

* `values` -
  (Required)
  The strings in the list.

## Attributes Reference

In addition to the arguments listed above, the following computed attributes are exported:

* `id` - an identifier for the resource with format `organizations/{{organization}}/locations/{{location}}/cloudControls/{{cloud_control_id}}`

* `create_time` -
  The last updated time of the cloud control.
  The create_time is used because a new CC is created whenever we update an
  existing CC.

* `major_revision_id` -
  Major revision of the cloud control incremented in ascending order.

* `name` -
  Identifier. The resource name of the cloud control.
  Format:
  organizations/{organization}/locations/{location}/cloudControls/{cloud_control_id}

* `related_frameworks` -
  The Frameworks that include this CloudControl

* `supported_enforcement_modes` -
  The supported enforcement mode of the cloud control. Default is DETECTIVE.

* `supported_target_resource_types` -
  target resource types supported by the CloudControl.


## Timeouts

This resource provides the following
[Timeouts](https://developer.hashicorp.com/terraform/plugin/sdkv2/resources/retries-and-customizable-timeouts) configuration options:

- `create` - Default is 20 minutes.
- `update` - Default is 20 minutes.
- `delete` - Default is 20 minutes.

## Import


CloudControl can be imported using any of these accepted formats:

* `organizations/{{organization}}/locations/{{location}}/cloudControls/{{cloud_control_id}}`
* `{{organization}}/{{location}}/{{cloud_control_id}}`

In Terraform v1.12.0 and later, use an [`identity` block](https://developer.hashicorp.com/terraform/language/resources/identities) to import CloudControl using identity values. For example:

```tf
import {
  identity = {
    organization = "<-required value->"
    location = "<-required value->"
    cloudControlId = "<-required value->"
  }
  to = google_cloud_security_compliance_cloud_control.default
}
```

In Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import CloudControl using one of the formats above. For example:

```tf
import {
  id = "organizations/{{organization}}/locations/{{location}}/cloudControls/{{cloud_control_id}}"
  to = google_cloud_security_compliance_cloud_control.default
}
```

When using the [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import), CloudControl can be imported using one of the formats above. For example:

```
$ terraform import google_cloud_security_compliance_cloud_control.default organizations/{{organization}}/locations/{{location}}/cloudControls/{{cloud_control_id}}
$ terraform import google_cloud_security_compliance_cloud_control.default {{organization}}/{{location}}/{{cloud_control_id}}
```
