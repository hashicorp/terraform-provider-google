---
# ----------------------------------------------------------------------------
#
#     ***     AUTO GENERATED CODE    ***    AUTO GENERATED CODE     ***
#
# ----------------------------------------------------------------------------
#
#     This file is automatically generated by Magic Modules and manual
#     changes will be clobbered when the file is regenerated.
#
#     Please read more about how to change this file in
#     .github/CONTRIBUTING.md.
#
# ----------------------------------------------------------------------------
subcategory: "Compute Engine"
layout: "google"
page_title: "Google: google_compute_global_forwarding_rule"
sidebar_current: "docs-google-compute-global-forwarding-rule"
description: |-
  Represents a GlobalForwardingRule resource.
---

# google\_compute\_global\_forwarding\_rule

Represents a GlobalForwardingRule resource. Global forwarding rules are
used to forward traffic to the correct load balancer for HTTP load
balancing. Global forwarding rules can only be used for HTTP load
balancing.

For more information, see
https://cloud.google.com/compute/docs/load-balancing/http/



<div class = "oics-button" style="float: right; margin: 0 0 -15px">
  <a href="https://console.cloud.google.com/cloudshell/open?cloudshell_git_repo=https%3A%2F%2Fgithub.com%2Fterraform-google-modules%2Fdocs-examples.git&cloudshell_working_dir=global_forwarding_rule_http&cloudshell_image=gcr.io%2Fgraphite-cloud-shell-images%2Fterraform%3Alatest&open_in_editor=main.tf&cloudshell_print=.%2Fmotd&cloudshell_tutorial=.%2Ftutorial.md" target="_blank">
    <img alt="Open in Cloud Shell" src="//gstatic.com/cloudssh/images/open-btn.svg" style="max-height: 44px; margin: 32px auto; max-width: 100%;">
  </a>
</div>
## Example Usage - Global Forwarding Rule Http


```hcl
resource "google_compute_global_forwarding_rule" "default" {
  name       = "global-rule"
  target     = google_compute_target_http_proxy.default.self_link
  port_range = "80"
}

resource "google_compute_target_http_proxy" "default" {
  name        = "target-proxy"
  description = "a description"
  url_map     = google_compute_url_map.default.self_link
}

resource "google_compute_url_map" "default" {
  name            = "url-map-target-proxy"
  description     = "a description"
  default_service = google_compute_backend_service.default.self_link

  host_rule {
    hosts        = ["mysite.com"]
    path_matcher = "allpaths"
  }

  path_matcher {
    name            = "allpaths"
    default_service = google_compute_backend_service.default.self_link

    path_rule {
      paths   = ["/*"]
      service = google_compute_backend_service.default.self_link
    }
  }
}

resource "google_compute_backend_service" "default" {
  name        = "backend"
  port_name   = "http"
  protocol    = "HTTP"
  timeout_sec = 10

  health_checks = [google_compute_http_health_check.default.self_link]
}

resource "google_compute_http_health_check" "default" {
  name               = "check-backend"
  request_path       = "/"
  check_interval_sec = 1
  timeout_sec        = 1
}
```
<div class = "oics-button" style="float: right; margin: 0 0 -15px">
  <a href="https://console.cloud.google.com/cloudshell/open?cloudshell_git_repo=https%3A%2F%2Fgithub.com%2Fterraform-google-modules%2Fdocs-examples.git&cloudshell_working_dir=global_forwarding_rule_internal&cloudshell_image=gcr.io%2Fgraphite-cloud-shell-images%2Fterraform%3Alatest&open_in_editor=main.tf&cloudshell_print=.%2Fmotd&cloudshell_tutorial=.%2Ftutorial.md" target="_blank">
    <img alt="Open in Cloud Shell" src="//gstatic.com/cloudssh/images/open-btn.svg" style="max-height: 44px; margin: 32px auto; max-width: 100%;">
  </a>
</div>
## Example Usage - Global Forwarding Rule Internal


```hcl
resource "google_compute_global_forwarding_rule" "default" {
  provider              = google-beta
  name                  = "global-rule"
  target                = google_compute_target_http_proxy.default.self_link
  port_range            = "80"
  load_balancing_scheme = "INTERNAL_SELF_MANAGED"
  ip_address            = "0.0.0.0"
  metadata_filters {
    filter_match_criteria = "MATCH_ANY"
    filter_labels {
      name  = "PLANET"
      value = "MARS"
    }
  }
}

resource "google_compute_target_http_proxy" "default" {
  provider    = google-beta
  name        = "target-proxy"
  description = "a description"
  url_map     = google_compute_url_map.default.self_link
}

resource "google_compute_url_map" "default" {
  provider        = google-beta
  name            = "url-map-target-proxy"
  description     = "a description"
  default_service = google_compute_backend_service.default.self_link

  host_rule {
    hosts        = ["mysite.com"]
    path_matcher = "allpaths"
  }

  path_matcher {
    name            = "allpaths"
    default_service = google_compute_backend_service.default.self_link

    path_rule {
      paths   = ["/*"]
      service = google_compute_backend_service.default.self_link
    }
  }
}

resource "google_compute_backend_service" "default" {
  provider              = google-beta
  name                  = "backend"
  port_name             = "http"
  protocol              = "HTTP"
  timeout_sec           = 10
  load_balancing_scheme = "INTERNAL_SELF_MANAGED"

  backend {
    group                 = google_compute_instance_group_manager.igm.instance_group
    balancing_mode        = "RATE"
    capacity_scaler       = 0.4
    max_rate_per_instance = 50
  }

  health_checks = [google_compute_health_check.default.self_link]
}

data "google_compute_image" "debian_image" {
  provider = google-beta
  family   = "debian-9"
  project  = "debian-cloud"
}

resource "google_compute_instance_group_manager" "igm" {
  provider = google-beta
  name     = "igm-internal"
  version {
    instance_template = google_compute_instance_template.instance_template.self_link
    name              = "primary"
  }
  base_instance_name = "internal-glb"
  zone               = "us-central1-f"
  target_size        = 1
}

resource "google_compute_instance_template" "instance_template" {
  provider     = google-beta
  name         = "template-backend"
  machine_type = "n1-standard-1"

  network_interface {
    network = "default"
  }

  disk {
    source_image = data.google_compute_image.debian_image.self_link
    auto_delete  = true
    boot         = true
  }
}

resource "google_compute_health_check" "default" {
  provider           = google-beta
  name               = "check-backend"
  check_interval_sec = 1
  timeout_sec        = 1

  tcp_health_check {
    port = "80"
  }
}
```

## Argument Reference

The following arguments are supported:


* `name` -
  (Required)
  Name of the resource; provided by the client when the resource is
  created. The name must be 1-63 characters long, and comply with
  RFC1035. Specifically, the name must be 1-63 characters long and match
  the regular expression `[a-z]([-a-z0-9]*[a-z0-9])?` which means the
  first character must be a lowercase letter, and all following
  characters must be a dash, lowercase letter, or digit, except the last
  character, which cannot be a dash.

* `target` -
  (Required)
  The URL of the target resource to receive the matched traffic.
  The forwarded traffic must be of a type appropriate to the target object.
  For INTERNAL_SELF_MANAGED load balancing, only HTTP and HTTPS targets
  are valid.


- - -


* `description` -
  (Optional)
  An optional description of this resource. Provide this property when
  you create the resource.

* `ip_address` -
  (Optional)
  The IP address that this forwarding rule is serving on behalf of.
  Addresses are restricted based on the forwarding rule's load balancing
  scheme (EXTERNAL or INTERNAL) and scope (global or regional).
  When the load balancing scheme is EXTERNAL, for global forwarding
  rules, the address must be a global IP, and for regional forwarding
  rules, the address must live in the same region as the forwarding
  rule. If this field is empty, an ephemeral IPv4 address from the same
  scope (global or regional) will be assigned. A regional forwarding
  rule supports IPv4 only. A global forwarding rule supports either IPv4
  or IPv6.
  When the load balancing scheme is INTERNAL, this can only be an RFC
  1918 IP address belonging to the network/subnet configured for the
  forwarding rule. By default, if this field is empty, an ephemeral
  internal IP address will be automatically allocated from the IP range
  of the subnet or network configured for this forwarding rule.
  An address must be specified by a literal IP address. ~> **NOTE**: While
  the API allows you to specify various resource paths for an address resource
  instead, Terraform requires this to specifically be an IP address to
  avoid needing to fetching the IP address from resource paths on refresh
  or unnecessary diffs.

* `ip_protocol` -
  (Optional)
  The IP protocol to which this rule applies. Valid options are TCP,
  UDP, ESP, AH, SCTP or ICMP. When the load balancing scheme is
  INTERNAL_SELF_MANAGED, only TCP is valid.

* `ip_version` -
  (Optional)
  The IP Version that will be used by this global forwarding rule.
  Valid options are IPV4 or IPV6.

* `load_balancing_scheme` -
  (Optional)
  This signifies what the GlobalForwardingRule will be used for.
  The value of INTERNAL_SELF_MANAGED means that this will be used for
  Internal Global HTTP(S) LB. The value of EXTERNAL means that this
  will be used for External Global Load Balancing (HTTP(S) LB,
  External TCP/UDP LB, SSL Proxy)
  NOTE: Currently global forwarding rules cannot be used for INTERNAL
  load balancing.

* `metadata_filters` -
  (Optional)
  Opaque filter criteria used by Loadbalancer to restrict routing
  configuration to a limited set xDS compliant clients. In their xDS
  requests to Loadbalancer, xDS clients present node metadata. If a
  match takes place, the relevant routing configuration is made available
  to those proxies.
  For each metadataFilter in this list, if its filterMatchCriteria is set
  to MATCH_ANY, at least one of the filterLabels must match the
  corresponding label provided in the metadata. If its filterMatchCriteria
  is set to MATCH_ALL, then all of its filterLabels must match with
  corresponding labels in the provided metadata.
  metadataFilters specified here can be overridden by those specified in
  the UrlMap that this ForwardingRule references.
  metadataFilters only applies to Loadbalancers that have their
  loadBalancingScheme set to INTERNAL_SELF_MANAGED.  Structure is documented below.

* `port_range` -
  (Optional)
  This field is used along with the target field for TargetHttpProxy,
  TargetHttpsProxy, TargetSslProxy, TargetTcpProxy, TargetVpnGateway,
  TargetPool, TargetInstance.
  Applicable only when IPProtocol is TCP, UDP, or SCTP, only packets
  addressed to ports in the specified range will be forwarded to target.
  Forwarding rules with the same [IPAddress, IPProtocol] pair must have
  disjoint port ranges.
  Some types of forwarding target have constraints on the acceptable
  ports:
  * TargetHttpProxy: 80, 8080
  * TargetHttpsProxy: 443
  * TargetTcpProxy: 25, 43, 110, 143, 195, 443, 465, 587, 700, 993, 995,
                    1883, 5222
  * TargetSslProxy: 25, 43, 110, 143, 195, 443, 465, 587, 700, 993, 995,
                    1883, 5222
  * TargetVpnGateway: 500, 4500

* `project` - (Optional) The ID of the project in which the resource belongs.
    If it is not provided, the provider project is used.


The `metadata_filters` block supports:

* `filter_match_criteria` -
  (Required)
  Specifies how individual filterLabel matches within the list of
  filterLabels contribute towards the overall metadataFilter match.
  MATCH_ANY - At least one of the filterLabels must have a matching
  label in the provided metadata.
  MATCH_ALL - All filterLabels must have matching labels in the
  provided metadata.

* `filter_labels` -
  (Required)
  The list of label value pairs that must match labels in the
  provided metadata based on filterMatchCriteria
  This list must not be empty and can have at the most 64 entries.  Structure is documented below.


The `filter_labels` block supports:

* `name` -
  (Required)
  Name of the metadata label. The length must be between
  1 and 1024 characters, inclusive.

* `value` -
  (Required)
  The value that the label must match. The value has a maximum
  length of 1024 characters.


## Timeouts

This resource provides the following
[Timeouts](/docs/configuration/resources.html#timeouts) configuration options:

- `create` - Default is 4 minutes.
- `update` - Default is 4 minutes.
- `delete` - Default is 4 minutes.

## Import

GlobalForwardingRule can be imported using any of these accepted formats:

```
$ terraform import google_compute_global_forwarding_rule.default projects/{{project}}/global/forwardingRules/{{name}}
$ terraform import google_compute_global_forwarding_rule.default {{project}}/{{name}}
$ terraform import google_compute_global_forwarding_rule.default {{name}}
```

-> If you're importing a resource with beta features, make sure to include `-provider=google-beta`
as an argument so that Terraform uses the correct provider to import your resource.

## User Project Overrides

This resource supports [User Project Overrides](https://www.terraform.io/docs/providers/google/guides/provider_reference.html#user_project_override).
