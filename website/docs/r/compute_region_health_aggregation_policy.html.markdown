---
# ----------------------------------------------------------------------------
#
#     ***     AUTO GENERATED CODE    ***    Type: MMv1     ***
#
# ----------------------------------------------------------------------------
#
#     This code is generated by Magic Modules using the following:
#
#     Configuration: https:#github.com/GoogleCloudPlatform/magic-modules/tree/main/mmv1/products/compute/RegionHealthAggregationPolicy.yaml
#     Template:      https:#github.com/GoogleCloudPlatform/magic-modules/tree/main/mmv1/templates/terraform/resource.html.markdown.tmpl
#
#     DO NOT EDIT this file directly. Any changes made to this file will be
#     overwritten during the next generation cycle.
#
# ----------------------------------------------------------------------------
subcategory: "Compute Engine"
description: |-
  The Health Aggregation Policy specifies how to aggregate the service's constituent source health status to determine an aggregated health status result for the service.
---

# google_compute_region_health_aggregation_policy

The Health Aggregation Policy specifies how to aggregate the service's constituent source health status to determine an aggregated health status result for the service.  For example, you can specify a criteria such as “Consider the Health Source as `Healthy` if there are at least 5 healthy backend endpoints”. Or, you can specify a criteria like “Consider the Health Source as `Healthy` if minimum 60% of endpoints in the Backend are healthy”. The Health Aggregation Policy is applied to each Health Source (e.g. Backend Service) individually.

~> **Warning:** This resource is in beta, and should be used with the terraform-provider-google-beta provider.
See [Provider Versions](../guides/provider_versions.html.markdown) for more details on beta resources.

To get more information about RegionHealthAggregationPolicy, see:

* [API documentation](https://cloud.google.com/compute/docs/reference/rest/v1/healthAggregationPolicies)
* How-to Guides
    * [Health checks overview](https://cloud.google.com/load-balancing/docs/health-check-concepts)

## Example Usage - Compute Region Health Aggregation Policy Basic


```hcl
data "google_project" "project" {
  provider = google-beta
}

resource "google_compute_region_health_aggregation_policy" "example_test_health_aggregation_policy" {
  provider    = google-beta
  name        = "test-health-aggregation-policy"
  description = "Example health aggregation policy basic"
  region      = "us-central1"
}
```

## Argument Reference

The following arguments are supported:


* `region` -
  (Required)
  URL of the region where the health aggregation policy resides.

* `name` -
  (Required)
  Name of the resource. Provided by the client when the resource is created.
  The name must be 1-63 characters long, and comply with RFC1035.
  Specifically, the name must be 1-63 characters long and match the regular
  expression `[a-z]([-a-z0-9]*[a-z0-9])?` which means the first
  character must be a lowercase letter, and all following characters must
  be a dash, lowercase letter, or digit, except the last character, which
  cannot be a dash.


* `description` -
  (Optional)
  An optional description of this resource. Provide this property when you
  create the resource.

* `policy_type` -
  (Optional)
  Specifies the type of the healthAggregationPolicy. The only allowed value
  for global resources is `DNS_PUBLIC_IP_POLICY`. The only allowed
  value for regional resources is `BACKEND_SERVICE_POLICY`. Must
  be specified when the healthAggregationPolicy is created, and cannot be
  mutated.
  Default value is `BACKEND_SERVICE_POLICY`.
  Possible values are: `DNS_PUBLIC_IP_POLICY`, `BACKEND_SERVICE_POLICY`.

* `healthy_percent_threshold` -
  (Optional)
  Can only be set if the `policyType` field is
  `BACKEND_SERVICE_POLICY`. Specifies the threshold (as a
  percentage) of healthy endpoints required in order to consider the
  aggregated health result HEALTHY. Defaults to `60`. Must be in
  range [0, 100]. Not applicable if the `policyType` field is
  `DNB_PUBLIC_IP_POLICY`. Can be mutated. This field is optional,
  and will be set to the default if unspecified. Note that both this
  threshold and `minHealthyThreshold` must be satisfied in order
  for HEALTHY to be the aggregated result. "Endpoints" refers to network
  endpoints within a Network Endpoint Group or instances within an Instance
  Group.

* `min_healthy_threshold` -
  (Optional)
  Can only be set if the `policyType` field is
  `BACKEND_SERVICE_POLICY`. Specifies the minimum number of
  healthy endpoints required in order to consider the aggregated health
  result HEALTHY. Defaults to `1`. Must be positive. Not
  applicable if the `policyType` field is
  `DNB_PUBLIC_IP_POLICY`. Can be mutated. This field is optional,
  and will be set to the default if unspecified. Note that both this
  threshold and `healthyPercentThreshold` must be satisfied in
  order for HEALTHY to be the aggregated result. "Endpoints" refers to
  network endpoints within a Network Endpoint Group or instances within an
  Instance Group.

* `project` - (Optional) The ID of the project in which the resource belongs.
    If it is not provided, the provider project is used.

* `deletion_policy` - (Optional) Whether Terraform will be prevented from destroying the resource. Defaults to DELETE.
	When a 'terraform destroy' or 'terraform apply' would delete the resource,
	the command will fail if this field is set to "PREVENT" in Terraform state.
	When set to "ABANDON", the command will remove the resource from Terraform
	management without updating or deleting the resource in the API.
	When set to "DELETE", deleting the resource is allowed.


## Attributes Reference

In addition to the arguments listed above, the following computed attributes are exported:

* `id` - an identifier for the resource with format `projects/{{project}}/regions/{{region}}/healthAggregationPolicies/{{name}}`

* `id` -
  The unique identifier for the resource. This identifier is defined by the server.

* `creation_timestamp` -
  Creation timestamp in RFC3339 text format.

* `self_link_with_id` -
  Server-defined URL with id for the resource.

* `fingerprint` -
  Fingerprint of this resource. A hash of the contents stored in this object.
  This field is used in optimistic locking. This field will be ignored when
  inserting a `HealthAggregationPolicy`. An up-to-date fingerprint
  must be provided in order to patch the RegionHealthAggregationPolicy; Otherwise,
  the request will fail with error `412 conditionNotMet`. To see
  the latest fingerprint, make a `get()` request to retrieve the
  RegionHealthAggregationPolicy.


## Timeouts

This resource provides the following
[Timeouts](https://developer.hashicorp.com/terraform/plugin/sdkv2/resources/retries-and-customizable-timeouts) configuration options:

- `create` - Default is 20 minutes.
- `update` - Default is 20 minutes.
- `delete` - Default is 20 minutes.

## Import


RegionHealthAggregationPolicy can be imported using any of these accepted formats:

* `projects/{{project}}/regions/{{region}}/healthAggregationPolicies/{{name}}`
* `{{project}}/{{region}}/{{name}}`
* `{{region}}/{{name}}`
* `{{name}}`


In Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import RegionHealthAggregationPolicy using one of the formats above. For example:

```tf
import {
  id = "projects/{{project}}/regions/{{region}}/healthAggregationPolicies/{{name}}"
  to = google_compute_region_health_aggregation_policy.default
}
```

When using the [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import), RegionHealthAggregationPolicy can be imported using one of the formats above. For example:

```
$ terraform import google_compute_region_health_aggregation_policy.default projects/{{project}}/regions/{{region}}/healthAggregationPolicies/{{name}}
$ terraform import google_compute_region_health_aggregation_policy.default {{project}}/{{region}}/{{name}}
$ terraform import google_compute_region_health_aggregation_policy.default {{region}}/{{name}}
$ terraform import google_compute_region_health_aggregation_policy.default {{name}}
```

## User Project Overrides

This resource supports [User Project Overrides](https://registry.terraform.io/providers/hashicorp/google/latest/docs/guides/provider_reference#user_project_override).
