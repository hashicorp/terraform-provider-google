---
# ----------------------------------------------------------------------------
#
#     ***     AUTO GENERATED CODE    ***    Type: MMv1     ***
#
# ----------------------------------------------------------------------------
#
#     This code is generated by Magic Modules using the following:
#
#     Configuration: https:#github.com/GoogleCloudPlatform/magic-modules/tree/main/mmv1/products/compute/RegionCompositeHealthCheck.yaml
#     Template:      https:#github.com/GoogleCloudPlatform/magic-modules/tree/main/mmv1/templates/terraform/resource.html.markdown.tmpl
#
#     DO NOT EDIT this file directly. Any changes made to this file will be
#     overwritten during the next generation cycle.
#
# ----------------------------------------------------------------------------
subcategory: "Compute Engine"
description: |-
  A composite health check resource specifies the health source resources and
  the health destination resource to which the aggregated health result from
  the health source resources is delivered.
---

# google_compute_region_composite_health_check

A composite health check resource specifies the health source resources and
the health destination resource to which the aggregated health result from
the health source resources is delivered.

~> **Warning:** This resource is in beta, and should be used with the terraform-provider-google-beta provider.
See [Provider Versions](../guides/provider_versions.html.markdown) for more details on beta resources.

To get more information about RegionCompositeHealthCheck, see:

* [API documentation](https://cloud.google.com/compute/docs/reference/rest/v1/regionCompositeHealthChecks)
* How-to Guides
    * [Health checks overview](https://cloud.google.com/load-balancing/docs/health-check-concepts)

## Example Usage - Compute Region Composite Health Check Basic


```hcl
resource "google_compute_region_composite_health_check" "example_test_composite_health_check" {
  provider           = google-beta
  name               = "test-composite-health-check"
  description        = "test regional composite health check resource"
  region             = "us-central1"
  health_sources     = [google_compute_region_health_source.default.id]
  health_destination = google_compute_forwarding_rule.default.id
}

resource "google_compute_region_health_source" "default" {
  provider                  = google-beta
  name                      = "test-composite-health-check-hs"
  region                    = "us-central1"
  source_type               = "BACKEND_SERVICE"
  sources                   = [google_compute_region_backend_service.default.id]
  health_aggregation_policy = google_compute_region_health_aggregation_policy.hap.id
}

resource "google_compute_region_health_aggregation_policy" "hap" {
  provider    = google-beta
  name        = "test-composite-health-check-hap"
  description = "health aggregation policy for health source"
  region      = "us-central1"
}

resource "google_compute_health_check" "default" {
  provider = google-beta
  name     = "test-composite-health-check-hc"
  http_health_check {
    port = 80
  }
}

resource "google_compute_region_backend_service" "default" {
  provider              = google-beta
  name                  = "test-composite-health-check-bs"
  region                = "us-central1"
  health_checks         = [google_compute_health_check.default.id]
  load_balancing_scheme = "INTERNAL"
}

resource "google_compute_forwarding_rule" "default" {
  provider              = google-beta
  name                  = "test-composite-health-check-fr"
  region                = "us-central1"
  load_balancing_scheme = "INTERNAL"
  backend_service       = google_compute_region_backend_service.default.id
  network               = google_compute_network.default.id
  subnetwork            = google_compute_subnetwork.default.id
  ip_protocol           = "TCP"
  all_ports             = true
}

resource "google_compute_network" "default" {
  provider                = google-beta
  name                    = "test-composite-health-check-net"
  auto_create_subnetworks = false
}

resource "google_compute_subnetwork" "default" {
  provider      = google-beta
  name          = "test-composite-health-check-sub"
  ip_cidr_range = "10.2.0.0/16"
  region        = "us-central1"
  network       = google_compute_network.default.id
}
```

## Argument Reference

The following arguments are supported:


* `health_destination` -
  (Required)
  URL to the destination resource. Must be set. Must be a
  ForwardingRule. The ForwardingRule must have
  load balancing scheme INTERNAL or
  INTERNAL_MANAGED and must be regional and in the same region
  as the CompositeHealthCheck (cross-region deployment for
  INTERNAL_MANAGED is not supported). Can be mutated.

* `region` -
  (Required)
  URL of the region where the composite health check resides.

* `name` -
  (Required)
  Name of the resource. Provided by the client when the resource is created.
  The name must be 1-63 characters long, and comply with RFC1035.
  Specifically, the name must be 1-63 characters long and match the regular
  expression `[a-z]([-a-z0-9]*[a-z0-9])?` which means the first
  character must be a lowercase letter, and all following characters must
  be a dash, lowercase letter, or digit, except the last character, which
  cannot be a dash.


* `description` -
  (Optional)
  An optional description of this resource. Provide this property when you
  create the resource.

* `health_sources` -
  (Optional)
  URLs to the HealthSource resources whose results are AND'ed.
  I.e. he aggregated result is is HEALTHY only if all sources
  are HEALTHY. Must have at least 1. Must not have more than 10.
  Must be regional and in the same region as the
  CompositeHealthCheck. Can be mutated.

* `project` - (Optional) The ID of the project in which the resource belongs.
    If it is not provided, the provider project is used.



## Attributes Reference

In addition to the arguments listed above, the following computed attributes are exported:

* `id` - an identifier for the resource with format `projects/{{project}}/regions/{{region}}/compositeHealthChecks/{{name}}`

* `id` -
  The unique identifier for the resource. This identifier is defined by the server.

* `creation_timestamp` -
  Creation timestamp in RFC3339 text format.

* `self_link_with_id` -
  Server-defined URL with id for the resource.

* `fingerprint` -
  Fingerprint of this resource. A hash of the contents stored in this object.
  This field is used in optimistic locking. This field will be ignored when
  inserting a `CompositeHealthCheck`. An up-to-date fingerprint
  must be provided in order to patch the CompositeHealthCheck; Otherwise,
  the request will fail with error `412 conditionNotMet`. To see
  the latest fingerprint, make a `get()` request to retrieve the
  CompositeHealthCheck.


## Timeouts

This resource provides the following
[Timeouts](https://developer.hashicorp.com/terraform/plugin/sdkv2/resources/retries-and-customizable-timeouts) configuration options:

- `create` - Default is 20 minutes.
- `update` - Default is 20 minutes.
- `delete` - Default is 20 minutes.

## Import


RegionCompositeHealthCheck can be imported using any of these accepted formats:

* `projects/{{project}}/regions/{{region}}/compositeHealthChecks/{{name}}`
* `{{project}}/{{region}}/{{name}}`
* `{{region}}/{{name}}`
* `{{name}}`


In Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import RegionCompositeHealthCheck using one of the formats above. For example:

```tf
import {
  id = "projects/{{project}}/regions/{{region}}/compositeHealthChecks/{{name}}"
  to = google_compute_region_composite_health_check.default
}
```

When using the [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import), RegionCompositeHealthCheck can be imported using one of the formats above. For example:

```
$ terraform import google_compute_region_composite_health_check.default projects/{{project}}/regions/{{region}}/compositeHealthChecks/{{name}}
$ terraform import google_compute_region_composite_health_check.default {{project}}/{{region}}/{{name}}
$ terraform import google_compute_region_composite_health_check.default {{region}}/{{name}}
$ terraform import google_compute_region_composite_health_check.default {{name}}
```

## User Project Overrides

This resource supports [User Project Overrides](https://registry.terraform.io/providers/hashicorp/google/latest/docs/guides/provider_reference#user_project_override).
