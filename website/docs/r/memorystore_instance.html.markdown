---
# ----------------------------------------------------------------------------
#
#     ***     AUTO GENERATED CODE    ***    Type: MMv1     ***
#
# ----------------------------------------------------------------------------
#
#     This code is generated by Magic Modules using the following:
#
#     Configuration: https:#github.com/GoogleCloudPlatform/magic-modules/tree/main/mmv1/products/memorystore/Instance.yaml
#     Template:      https:#github.com/GoogleCloudPlatform/magic-modules/tree/main/mmv1/templates/terraform/resource.html.markdown.tmpl
#
#     DO NOT EDIT this file directly. Any changes made to this file will be
#     overwritten during the next generation cycle.
#
# ----------------------------------------------------------------------------
subcategory: "Memorystore"
description: |-
  A Google Cloud Memorystore instance.
---

# google_memorystore_instance

A Google Cloud Memorystore instance.


To get more information about Instance, see:

* [API documentation](https://cloud.google.com/memorystore/docs/valkey/reference/rest/v1/projects.locations.instances)
* How-to Guides
    * [Official Documentation](https://cloud.google.com/memorystore/docs/valkey/create-instances)

<div class = "oics-button" style="float: right; margin: 0 0 -15px">
  <a href="https://console.cloud.google.com/cloudshell/open?cloudshell_git_repo=https%3A%2F%2Fgithub.com%2Fterraform-google-modules%2Fdocs-examples.git&cloudshell_image=gcr.io%2Fcloudshell-images%2Fcloudshell%3Alatest&cloudshell_print=.%2Fmotd&cloudshell_tutorial=.%2Ftutorial.md&cloudshell_working_dir=memorystore_instance_basic&open_in_editor=main.tf" target="_blank">
    <img alt="Open in Cloud Shell" src="//gstatic.com/cloudssh/images/open-btn.svg" style="max-height: 44px; margin: 32px auto; max-width: 100%;">
  </a>
</div>
## Example Usage - Memorystore Instance Basic


```hcl
resource "google_memorystore_instance" "instance-basic" {
  instance_id = "basic-instance"
  shard_count = 1
  desired_auto_created_endpoints {
    network    = google_compute_network.producer_net.id
    project_id = data.google_project.project.project_id
  }
  location                    = "us-central1"
  deletion_protection_enabled = false
  maintenance_policy {
    weekly_maintenance_window {
      day = "MONDAY"
      start_time {
        hours = 1
        minutes = 0
        seconds = 0
        nanos = 0
      }
    }
  }
  depends_on = [
    google_network_connectivity_service_connection_policy.default
  ]

  lifecycle {
    prevent_destroy = "true"
  }
}

resource "google_network_connectivity_service_connection_policy" "default" {
  name          = "my-policy"
  location      = "us-central1"
  service_class = "gcp-memorystore"
  description   = "my basic service connection policy"
  network       = google_compute_network.producer_net.id
  psc_config {
    subnetworks = [google_compute_subnetwork.producer_subnet.id]
  }
}

resource "google_compute_subnetwork" "producer_subnet" {
  name          = "my-subnet"
  ip_cidr_range = "10.0.0.248/29"
  region        = "us-central1"
  network       = google_compute_network.producer_net.id
}

resource "google_compute_network" "producer_net" {
  name                    = "my-network"
  auto_create_subnetworks = false
}

data "google_project" "project" {
}
```
<div class = "oics-button" style="float: right; margin: 0 0 -15px">
  <a href="https://console.cloud.google.com/cloudshell/open?cloudshell_git_repo=https%3A%2F%2Fgithub.com%2Fterraform-google-modules%2Fdocs-examples.git&cloudshell_image=gcr.io%2Fcloudshell-images%2Fcloudshell%3Alatest&cloudshell_print=.%2Fmotd&cloudshell_tutorial=.%2Ftutorial.md&cloudshell_working_dir=memorystore_instance_full&open_in_editor=main.tf" target="_blank">
    <img alt="Open in Cloud Shell" src="//gstatic.com/cloudssh/images/open-btn.svg" style="max-height: 44px; margin: 32px auto; max-width: 100%;">
  </a>
</div>
## Example Usage - Memorystore Instance Full


```hcl
resource "google_memorystore_instance" "instance-full" {
  instance_id = "full-instance"
  shard_count = 1
  desired_auto_created_endpoints {
    network    = google_compute_network.producer_net.id
    project_id = data.google_project.project.project_id
  }
  location                = "us-central1"
  replica_count           = 1
  node_type               = "SHARED_CORE_NANO"
  transit_encryption_mode = "TRANSIT_ENCRYPTION_DISABLED"
  authorization_mode      = "AUTH_DISABLED"
  kms_key                 = "my-key"
  engine_configs = {
    maxmemory-policy = "volatile-ttl"
  }
  zone_distribution_config {
    mode = "SINGLE_ZONE"
    zone = "us-central1-b"
  }
  maintenance_policy {
    weekly_maintenance_window {
      day = "MONDAY"
      start_time {
        hours = 1
        minutes = 0
        seconds = 0
        nanos = 0
      }
    }
  }
  engine_version              = "VALKEY_7_2"
  deletion_protection_enabled = false
  mode = "CLUSTER"
  persistence_config {
    mode = "RDB"
    rdb_config {
      rdb_snapshot_period     = "ONE_HOUR"
      rdb_snapshot_start_time = "2024-10-02T15:01:23Z"
    }
  }
  labels = {
    "abc" : "xyz"
  }
  depends_on = [
    google_network_connectivity_service_connection_policy.default
  ]

  lifecycle {
    prevent_destroy = "true"
  }
}

resource "google_network_connectivity_service_connection_policy" "default" {
  name          = "my-policy"
  location      = "us-central1"
  service_class = "gcp-memorystore"
  description   = "my basic service connection policy"
  network       = google_compute_network.producer_net.id
  psc_config {
    subnetworks = [google_compute_subnetwork.producer_subnet.id]
  }
}

resource "google_compute_subnetwork" "producer_subnet" {
  name          = "my-subnet"
  ip_cidr_range = "10.0.0.248/29"
  region        = "us-central1"
  network       = google_compute_network.producer_net.id
}

resource "google_compute_network" "producer_net" {
  name                    = "my-network"
  auto_create_subnetworks = false
}

data "google_project" "project" {
}
```
<div class = "oics-button" style="float: right; margin: 0 0 -15px">
  <a href="https://console.cloud.google.com/cloudshell/open?cloudshell_git_repo=https%3A%2F%2Fgithub.com%2Fterraform-google-modules%2Fdocs-examples.git&cloudshell_image=gcr.io%2Fcloudshell-images%2Fcloudshell%3Alatest&cloudshell_print=.%2Fmotd&cloudshell_tutorial=.%2Ftutorial.md&cloudshell_working_dir=memorystore_instance_persistence_aof&open_in_editor=main.tf" target="_blank">
    <img alt="Open in Cloud Shell" src="//gstatic.com/cloudssh/images/open-btn.svg" style="max-height: 44px; margin: 32px auto; max-width: 100%;">
  </a>
</div>
## Example Usage - Memorystore Instance Persistence Aof


```hcl
resource "google_memorystore_instance" "instance-persistence-aof" {
  instance_id = "aof-instance"
  shard_count = 1
  desired_auto_created_endpoints {
    network    = google_compute_network.producer_net.id
    project_id = data.google_project.project.project_id
  }
  location = "us-central1"
  persistence_config {
    mode = "AOF"
    aof_config {
      append_fsync = "EVERY_SEC"
    }
  }
  depends_on = [
    google_network_connectivity_service_connection_policy.default
  ]
  deletion_protection_enabled = false
  lifecycle {
    prevent_destroy = "true"
  }
}

resource "google_network_connectivity_service_connection_policy" "default" {
  name          = "my-policy"
  location      = "us-central1"
  service_class = "gcp-memorystore"
  description   = "my basic service connection policy"
  network       = google_compute_network.producer_net.id
  psc_config {
    subnetworks = [google_compute_subnetwork.producer_subnet.id]
  }
}

resource "google_compute_subnetwork" "producer_subnet" {
  name          = "my-subnet"
  ip_cidr_range = "10.0.0.248/29"
  region        = "us-central1"
  network       = google_compute_network.producer_net.id
}

resource "google_compute_network" "producer_net" {
  name                    = "my-network"
  auto_create_subnetworks = false
}

data "google_project" "project" {
}
```
<div class = "oics-button" style="float: right; margin: 0 0 -15px">
  <a href="https://console.cloud.google.com/cloudshell/open?cloudshell_git_repo=https%3A%2F%2Fgithub.com%2Fterraform-google-modules%2Fdocs-examples.git&cloudshell_image=gcr.io%2Fcloudshell-images%2Fcloudshell%3Alatest&cloudshell_print=.%2Fmotd&cloudshell_tutorial=.%2Ftutorial.md&cloudshell_working_dir=memorystore_instance_secondary_instance&open_in_editor=main.tf" target="_blank">
    <img alt="Open in Cloud Shell" src="//gstatic.com/cloudssh/images/open-btn.svg" style="max-height: 44px; margin: 32px auto; max-width: 100%;">
  </a>
</div>
## Example Usage - Memorystore Instance Secondary Instance


```hcl
// Primary instance
resource "google_memorystore_instance" "primary_instance" {
  instance_id                    = "primary-instance"
  shard_count                    = 1
  desired_auto_created_endpoints {
    network                      = google_compute_network.primary_producer_net.id
    project_id                   = data.google_project.project.project_id
  }
  location                       = "asia-east1"
  replica_count                  = 1
  node_type                      = "SHARED_CORE_NANO"
  transit_encryption_mode        = "TRANSIT_ENCRYPTION_DISABLED"
  authorization_mode             = "AUTH_DISABLED"
  engine_configs = {
    maxmemory-policy             = "volatile-ttl"
  }
  zone_distribution_config {
    mode                         = "SINGLE_ZONE"
    zone                         = "asia-east1-c"
  }
  deletion_protection_enabled    = true
  persistence_config {
    mode                         = "RDB"
    rdb_config {
      rdb_snapshot_period        = "ONE_HOUR"
      rdb_snapshot_start_time    = "2024-10-02T15:01:23Z"
    }
  }
  labels = {
    "abc" : "xyz"
  }
  depends_on                     = [google_network_connectivity_service_connection_policy.primary_policy]

  lifecycle {
    prevent_destroy              =  true
  }
}

resource "google_network_connectivity_service_connection_policy" "primary_policy" {
  name                           = "my-policy-primary-instance"
  location                       = "asia-east1"
  service_class                  = "gcp-memorystore"
  description                    = "my basic service connection policy"
  network                        = google_compute_network.primary_producer_net.id
  psc_config {                 
    subnetworks                  = [google_compute_subnetwork.primary_producer_subnet.id]
  }
}

resource "google_compute_subnetwork" "primary_producer_subnet" {
  name                           = "my-subnet-primary-instance"
  ip_cidr_range                  = "10.0.1.0/29"
  region                         = "asia-east1"
  network                        = google_compute_network.primary_producer_net.id
}

resource "google_compute_network" "primary_producer_net" {
  name                           = "my-network-primary-instance"
  auto_create_subnetworks        = false
}

// Secondary instance
resource "google_memorystore_instance" "secondary_instance" {
  instance_id                    = "secondary-instance"
  shard_count                    = 1
  desired_auto_created_endpoints {
    network                      = google_compute_network.secondary_producer_net.id
    project_id                   = data.google_project.project.project_id
  }
  location                       = "europe-north1"
  replica_count                  = 1
  node_type                      = "SHARED_CORE_NANO"
  transit_encryption_mode        = "TRANSIT_ENCRYPTION_DISABLED"
  authorization_mode             = "AUTH_DISABLED"
  engine_configs = {
    maxmemory-policy             = "volatile-ttl"
  }
  zone_distribution_config {
    mode                         = "SINGLE_ZONE"
    zone                         = "europe-north1-c"
  }
  deletion_protection_enabled    = true
  // Cross instance replication config
  cross_instance_replication_config {
    instance_role                 = "SECONDARY"
    primary_instance {
      instance                    = google_memorystore_instance.primary_instance.id
    }
  }
  persistence_config {
    mode                         = "RDB"
    rdb_config {
      rdb_snapshot_period        = "ONE_HOUR"
      rdb_snapshot_start_time    = "2024-10-02T15:01:23Z"
    }
  }
  labels = {
    "abc" : "xyz"
  }
  depends_on                     = [google_network_connectivity_service_connection_policy.secondary_policy]

  lifecycle {
    prevent_destroy              = true
  }
}

resource "google_network_connectivity_service_connection_policy" "secondary_policy" {
  name                           = "my-policy-secondary-instance"
  location                       = "europe-north1"
  service_class                  = "gcp-memorystore"
  description                    = "my basic service connection policy"
  network                        = google_compute_network.secondary_producer_net.id
  psc_config {                 
    subnetworks                  = [google_compute_subnetwork.secondary_producer_subnet.id]
  }
}

resource "google_compute_subnetwork" "secondary_producer_subnet" {
  name                           = "my-subnet-secondary-instance"
  ip_cidr_range                  = "10.0.2.0/29"
  region                         = "europe-north1"
  network                        = google_compute_network.secondary_producer_net.id
}

resource "google_compute_network" "secondary_producer_net" {
  name                           =  "my-network-secondary-instance"
  auto_create_subnetworks        = false
}

data "google_project" "project" {
}
```

## Argument Reference

The following arguments are supported:


* `shard_count` -
  (Required)
  Required. Number of shards for the instance.

* `location` -
  (Required)
  Resource ID segment making up resource `name`. It identifies the resource within its parent collection as described in https://google.aip.dev/122. See documentation for resource type `memorystore.googleapis.com/CertificateAuthority`.

* `instance_id` -
  (Required)
  Required. The ID to use for the instance, which will become the final component of
  the instance's resource name.
  This value is subject to the following restrictions:
  * Must be 4-63 characters in length
  * Must begin with a letter or digit
  * Must contain only lowercase letters, digits, and hyphens
  * Must not end with a hyphen
  * Must be unique within a location


* `labels` -
  (Optional)
  Optional. Labels to represent user-provided metadata. 
  **Note**: This field is non-authoritative, and will only manage the labels present in your configuration.
  Please refer to the field `effective_labels` for all of the labels present on the resource.

* `automated_backup_config` -
  (Optional)
  The automated backup config for a instance.
  Structure is [documented below](#nested_automated_backup_config).

* `replica_count` -
  (Optional)
  Optional. Number of replica nodes per shard. If omitted the default is 0 replicas.

* `authorization_mode` -
  (Optional)
  Optional. Immutable. Authorization mode of the instance. Possible values:
   AUTH_DISABLED
  IAM_AUTH

* `transit_encryption_mode` -
  (Optional)
  Optional. Immutable. In-transit encryption mode of the instance. 
   Possible values:
   TRANSIT_ENCRYPTION_DISABLED
  SERVER_AUTHENTICATION

* `node_type` -
  (Optional)
  Optional. Machine type for individual nodes of the instance. 
   Possible values:
   SHARED_CORE_NANO
  HIGHMEM_MEDIUM
  HIGHMEM_XLARGE
  STANDARD_SMALL

* `persistence_config` -
  (Optional)
  Represents persistence configuration for a instance.
  Structure is [documented below](#nested_persistence_config).

* `maintenance_policy` -
  (Optional)
  Maintenance policy for a cluster
  Structure is [documented below](#nested_maintenance_policy).

* `engine_version` -
  (Optional)
  Optional. Engine version of the instance.

* `engine_configs` -
  (Optional)
  Optional. User-provided engine configurations for the instance.

* `zone_distribution_config` -
  (Optional)
  Zone distribution configuration for allocation of instance resources.
  Structure is [documented below](#nested_zone_distribution_config).

* `deletion_protection_enabled` -
  (Optional)
  Optional. If set to true deletion of the instance will fail.

* `cross_instance_replication_config` -
  (Optional)
  Cross instance replication config
  Structure is [documented below](#nested_cross_instance_replication_config).

* `mode` -
  (Optional)
  Optional. cluster or cluster-disabled. 
   Possible values:
   CLUSTER
   CLUSTER_DISABLED
  Possible values are: `CLUSTER`, `CLUSTER_DISABLED`.

* `gcs_source` -
  (Optional)
  GCS source for the instance.
  Structure is [documented below](#nested_gcs_source).

* `managed_backup_source` -
  (Optional)
  Managed backup source for the instance.
  Structure is [documented below](#nested_managed_backup_source).

* `kms_key` -
  (Optional)
  The KMS key used to encrypt the at-rest data of the cluster

* `project` - (Optional) The ID of the project in which the resource belongs.
    If it is not provided, the provider project is used.

* `desired_psc_auto_connections` - (Optional) `desired_psc_auto_connections` is deprecated  Use `desired_auto_created_endpoints` instead.
* `desired_auto_created_endpoints` - (Optional) Immutable. User inputs for the auto-created endpoints connections. 


<a name="nested_automated_backup_config"></a>The `automated_backup_config` block supports:

* `fixed_frequency_schedule` -
  (Required)
  Trigger automated backups at a fixed frequency.
  Structure is [documented below](#nested_automated_backup_config_fixed_frequency_schedule).

* `retention` -
  (Required)
  How long to keep automated backups before the backups are deleted.
  The value should be between 1 day and 365 days. If not specified, the default value is 35 days.
  A duration in seconds with up to nine fractional digits, ending with 's'. Example: "3.5s". The default_value is "3024000s"


<a name="nested_automated_backup_config_fixed_frequency_schedule"></a>The `fixed_frequency_schedule` block supports:

* `start_time` -
  (Required)
  The start time of every automated backup in UTC.
  It must be set to the start of an hour. This field is required.
  Structure is [documented below](#nested_automated_backup_config_fixed_frequency_schedule_start_time).


<a name="nested_automated_backup_config_fixed_frequency_schedule_start_time"></a>The `start_time` block supports:

* `hours` -
  (Required)
  Hours of a day in 24 hour format. Must be greater than or equal to 0 and typically must be less than or equal to 23.
  An API may choose to allow the value "24:00:00" for scenarios like business closing time.

<a name="nested_persistence_config"></a>The `persistence_config` block supports:

* `mode` -
  (Optional)
  Optional. Current persistence mode. 
   Possible values:
  DISABLED
  RDB
  AOF
  Possible values are: `DISABLED`, `RDB`, `AOF`.

* `rdb_config` -
  (Optional)
  Configuration for RDB based persistence.
  Structure is [documented below](#nested_persistence_config_rdb_config).

* `aof_config` -
  (Optional)
  Configuration for AOF based persistence.
  Structure is [documented below](#nested_persistence_config_aof_config).


<a name="nested_persistence_config_rdb_config"></a>The `rdb_config` block supports:

* `rdb_snapshot_period` -
  (Optional)
  Optional. Period between RDB snapshots. 
   Possible values:
   ONE_HOUR
  SIX_HOURS
  TWELVE_HOURS
  TWENTY_FOUR_HOURS

* `rdb_snapshot_start_time` -
  (Optional)
  Optional. Time that the first snapshot was/will be attempted, and to which future
  snapshots will be aligned. If not provided, the current time will be
  used.

<a name="nested_persistence_config_aof_config"></a>The `aof_config` block supports:

* `append_fsync` -
  (Optional)
  Optional. The fsync mode. 
   Possible values:
   NEVER
  EVERY_SEC
  ALWAYS

<a name="nested_maintenance_policy"></a>The `maintenance_policy` block supports:

* `create_time` -
  (Output)
  The time when the policy was created.
  A timestamp in RFC3339 UTC "Zulu" format, with nanosecond
  resolution and up to nine fractional digits.

* `update_time` -
  (Output)
  The time when the policy was last updated.
  A timestamp in RFC3339 UTC "Zulu" format, with nanosecond
  resolution and up to nine fractional digits.

* `weekly_maintenance_window` -
  (Optional)
  Optional. Maintenance window that is applied to resources covered by this policy.
  Minimum 1. For the current version, the maximum number
  of weekly_window is expected to be one.
  Structure is [documented below](#nested_maintenance_policy_weekly_maintenance_window).


<a name="nested_maintenance_policy_weekly_maintenance_window"></a>The `weekly_maintenance_window` block supports:

* `day` -
  (Required)
  The day of week that maintenance updates occur.
  - DAY_OF_WEEK_UNSPECIFIED: The day of the week is unspecified.
  - MONDAY: Monday
  - TUESDAY: Tuesday
  - WEDNESDAY: Wednesday
  - THURSDAY: Thursday
  - FRIDAY: Friday
  - SATURDAY: Saturday
  - SUNDAY: Sunday
  Possible values are: `DAY_OF_WEEK_UNSPECIFIED`, `MONDAY`, `TUESDAY`, `WEDNESDAY`, `THURSDAY`, `FRIDAY`, `SATURDAY`, `SUNDAY`.

* `duration` -
  (Output)
  Duration of the maintenance window.
  The current window is fixed at 1 hour.
  A duration in seconds with up to nine fractional digits,
  terminated by 's'. Example: "3.5s".

* `start_time` -
  (Required)
  Start time of the window in UTC time.
  Structure is [documented below](#nested_maintenance_policy_weekly_maintenance_window_weekly_maintenance_window_start_time).


<a name="nested_maintenance_policy_weekly_maintenance_window_weekly_maintenance_window_start_time"></a>The `start_time` block supports:

* `hours` -
  (Optional)
  Hours of day in 24 hour format. Should be from 0 to 23.
  An API may choose to allow the value "24:00:00" for scenarios like business closing time.

* `minutes` -
  (Optional)
  Minutes of hour of day. Must be from 0 to 59.

* `seconds` -
  (Optional)
  Seconds of minutes of the time. Must normally be from 0 to 59.
  An API may allow the value 60 if it allows leap-seconds.

* `nanos` -
  (Optional)
  Fractions of seconds in nanoseconds. Must be from 0 to 999,999,999.

<a name="nested_zone_distribution_config"></a>The `zone_distribution_config` block supports:

* `zone` -
  (Optional)
  Optional. Defines zone where all resources will be allocated with SINGLE_ZONE mode.
  Ignored for MULTI_ZONE mode.

* `mode` -
  (Optional)
  Optional. Current zone distribution mode. Defaults to MULTI_ZONE. 
   Possible values:
   MULTI_ZONE
  SINGLE_ZONE
  Possible values are: `MULTI_ZONE`, `SINGLE_ZONE`.

<a name="nested_cross_instance_replication_config"></a>The `cross_instance_replication_config` block supports:

* `instance_role` -
  (Optional)
  The instance role supports the following values:
  1. `INSTANCE_ROLE_UNSPECIFIED`: This is an independent instance that has never participated in cross instance replication. It allows both reads and writes.
  2. `NONE`: This is an independent instance that previously participated in cross instance replication(either as a `PRIMARY` or `SECONDARY` cluster). It allows both reads and writes.
  3. `PRIMARY`: This instance serves as the replication source for secondary instance that are replicating from it. Any data written to it is automatically replicated to its secondary clusters. It allows both reads and writes.
  4. `SECONDARY`: This instance replicates data from the primary instance. It allows only reads.
  Possible values are: `INSTANCE_ROLE_UNSPECIFIED`, `NONE`, `PRIMARY`, `SECONDARY`.

* `primary_instance` -
  (Optional)
  This field is only set for a secondary instance. Details of the primary instance that is used as the replication source for this secondary instance. This is allowed to be set only for clusters whose cluster role is of type `SECONDARY`.
  Structure is [documented below](#nested_cross_instance_replication_config_primary_instance).

* `secondary_instances` -
  (Optional)
  List of secondary instances that are replicating from this primary cluster. This is allowed to be set only for instances whose cluster role is of type `PRIMARY`.
  Structure is [documented below](#nested_cross_instance_replication_config_secondary_instances).

* `membership` -
  (Output)
  An output only view of all the member instance participating in cross instance replication. This field is populated for all the member clusters irrespective of their cluster role.
  Structure is [documented below](#nested_cross_instance_replication_config_membership).

* `update_time` -
  (Output)
  The last time cross instance replication config was updated.


<a name="nested_cross_instance_replication_config_primary_instance"></a>The `primary_instance` block supports:

* `instance` -
  (Optional)
  The full resource path of the primary instance in the format: projects/{project}/locations/{region}/instances/{instance-id}

* `uid` -
  (Output)
  The unique id of the primary instance.

<a name="nested_cross_instance_replication_config_secondary_instances"></a>The `secondary_instances` block supports:

* `instance` -
  (Optional)
  The full resource path of the Nth instance in the format: projects/{project}/locations/{region}/instance/{instance-id}

* `uid` -
  (Output)
  The unique id of the Nth instance.

<a name="nested_cross_instance_replication_config_membership"></a>The `membership` block contains:

* `primary_instance` -
  (Output)
  Details of the primary instance that is used as the replication source for all the secondary instances.
  Structure is [documented below](#nested_cross_instance_replication_config_membership_primary_instance).

* `secondary_instance` -
  (Output)
  List of secondary instances that are replicating from the primary instance.
  Structure is [documented below](#nested_cross_instance_replication_config_membership_secondary_instance).


<a name="nested_cross_instance_replication_config_membership_primary_instance"></a>The `primary_instance` block contains:

* `instance` -
  (Output)
  The full resource path of the primary instance in the format: projects/{project}/locations/{region}/instance/{instance-id}

* `uid` -
  (Output)
  The unique id of the primary instance.

<a name="nested_cross_instance_replication_config_membership_secondary_instance"></a>The `secondary_instance` block contains:

* `instance` -
  (Output)
  The full resource path of the secondary instance in the format: projects/{project}/locations/{region}/instance/{instance-id}

* `uid` -
  (Output)
  The unique id of the secondary instance.

<a name="nested_gcs_source"></a>The `gcs_source` block supports:

* `uris` -
  (Required)
  URIs of the GCS objects to import.
  Example: gs://bucket1/object1, gs://bucket2/folder2/object2

<a name="nested_managed_backup_source"></a>The `managed_backup_source` block supports:

* `backup` -
  (Required)
  Example: `projects/{project}/locations/{location}/backupCollections/{collection}/backups/{backup}`.

## Attributes Reference

In addition to the arguments listed above, the following computed attributes are exported:

* `id` - an identifier for the resource with format `projects/{{project}}/locations/{{location}}/instances/{{instance_id}}`

* `name` -
  Identifier. Unique name of the instance.
  Format: projects/{project}/locations/{location}/instances/{instance}

* `create_time` -
  Output only. Creation timestamp of the instance.

* `update_time` -
  Output only. Latest update timestamp of the instance.

* `state` -
  Output only. Current state of the instance. 
   Possible values:
   CREATING
  ACTIVE
  UPDATING
  DELETING

* `state_info` -
  Additional information about the state of the instance.
  Structure is [documented below](#nested_state_info).

* `uid` -
  Output only. System assigned, unique identifier for the instance.

* `discovery_endpoints` -
  (Deprecated)
  Deprecated. Output only. Endpoints clients can connect to the instance through.
  Structure is [documented below](#nested_discovery_endpoints).

  ~> **Warning:** This field is deprecated. As a result it will not be populated if the connections are created using `desired_auto_created_endpoints` parameter or `google_memorystore_instance_desired_user_created_endpoints` resource. Instead of this parameter, for discovery, use `endpoints.connections.pscConnection` and `endpoints.connections.pscAutoConnection` with `connectionType` CONNECTION_TYPE_DISCOVERY.

* `maintenance_schedule` -
  Upcoming maintenance schedule.
  Structure is [documented below](#nested_maintenance_schedule).

* `node_config` -
  Represents configuration for nodes of the instance.
  Structure is [documented below](#nested_node_config).

* `endpoints` -
  Endpoints for the instance.
  Structure is [documented below](#nested_endpoints).

* `psc_attachment_details` -
  Configuration of a service attachment of the cluster, for creating PSC connections.
  Structure is [documented below](#nested_psc_attachment_details).

* `psc_auto_connections` -
  (Deprecated)
  Output only. User inputs and resource details of the auto-created PSC connections.
  Structure is [documented below](#nested_psc_auto_connections).

  ~> **Warning:** `psc_auto_connections` is deprecated  Use `endpoints.connections.pscAutoConnections` instead.

* `backup_collection` -
  The backup collection full resource name.
  Example: projects/{project}/locations/{location}/backupCollections/{collection}

* `managed_server_ca` -
  Instance's Certificate Authority. This field will only be populated if instance's transit_encryption_mode is SERVER_AUTHENTICATION
  Structure is [documented below](#nested_managed_server_ca).

* `terraform_labels` -
  The combination of labels configured directly on the resource
   and default labels configured on the provider.

* `effective_labels` -
  All of labels (key/value pairs) present on the resource in GCP, including the labels configured through Terraform, other clients and services.


<a name="nested_state_info"></a>The `state_info` block contains:

* `update_info` -
  (Output)
  Represents information about instance with state UPDATING.
  Structure is [documented below](#nested_state_info_update_info).


<a name="nested_state_info_update_info"></a>The `update_info` block contains:

* `target_shard_count` -
  (Output)
  Output only. Target number of shards for the instance.

* `target_replica_count` -
  (Output)
  Output only. Target number of replica nodes per shard for the instance.

* `target_engine_version` -
  (Output)
  Output only. Target engine version for the instance.

* `target_node_type` -
  (Output)
  Output only. Target node type for the instance.

<a name="nested_discovery_endpoints"></a>The `discovery_endpoints` block contains:

* `address` -
  (Output)
  Output only. IP address of the exposed endpoint clients connect to.

* `port` -
  (Output)
  Output only. The port number of the exposed endpoint.

* `network` -
  (Output)
  Output only. The network where the IP address of the discovery endpoint will be
  reserved, in the form of
  projects/{network_project}/global/networks/{network_id}.

<a name="nested_maintenance_schedule"></a>The `maintenance_schedule` block contains:

* `start_time` -
  (Output)
  The start time of any upcoming scheduled maintenance for this cluster.
  A timestamp in RFC3339 UTC "Zulu" format, with nanosecond
  resolution and up to nine fractional digits.

* `end_time` -
  (Output)
  The end time of any upcoming scheduled maintenance for this cluster.
  A timestamp in RFC3339 UTC "Zulu" format, with nanosecond
  resolution and up to nine fractional digits.

* `schedule_deadline_time` -
  (Output)
  The deadline that the maintenance schedule start time
  can not go beyond, including reschedule.
  A timestamp in RFC3339 UTC "Zulu" format, with nanosecond
  resolution and up to nine fractional digits.

<a name="nested_node_config"></a>The `node_config` block contains:

* `size_gb` -
  (Output)
  Output only. Memory size in GB of the node.

<a name="nested_endpoints"></a>The `endpoints` block contains:

* `connections` -
  (Optional)
  A group of PSC connections. They are created in the same VPC network, one for each service attachment in the cluster.
  Structure is [documented below](#nested_endpoints_endpoints_connections).


<a name="nested_endpoints_endpoints_connections"></a>The `connections` block supports:

* `psc_auto_connection` -
  (Optional)
  Detailed information of a PSC connection that is created through service connectivity automation.
  Structure is [documented below](#nested_endpoints_endpoints_connections_connections_psc_auto_connection).


<a name="nested_endpoints_endpoints_connections_connections_psc_auto_connection"></a>The `psc_auto_connection` block supports:

* `psc_connection_id` -
  (Output)
  Output only. The PSC connection id of the forwarding rule connected to the
  service attachment.

* `ip_address` -
  (Output)
  Output only. The IP allocated on the consumer network for the PSC forwarding rule.

* `forwarding_rule` -
  (Output)
  Output only. The URI of the consumer side forwarding rule.
  Format:
  projects/{project}/regions/{region}/forwardingRules/{forwarding_rule}

* `project_id` -
  (Output)
  Output only. The consumer project_id where the forwarding rule is created from.

* `network` -
  (Output)
  Output only. The consumer network where the IP address resides, in the form of
  projects/{project_id}/global/networks/{network_id}.

* `service_attachment` -
  (Output)
  Output only. The service attachment which is the target of the PSC connection, in the form of projects/{project-id}/regions/{region}/serviceAttachments/{service-attachment-id}.

* `connection_type` -
  (Output)
  Output Only. Type of a PSC Connection. 
   Possible values:
   CONNECTION_TYPE_DISCOVERY 
   CONNECTION_TYPE_PRIMARY 
   CONNECTION_TYPE_READER

* `port` -
  (Output)
  Output only. Ports of the exposed endpoint.

<a name="nested_psc_attachment_details"></a>The `psc_attachment_details` block contains:

* `service_attachment` -
  (Output)
  Service attachment URI which your self-created PscConnection should use as target.

* `connection_type` -
  (Output)
  Service attachment URI which your self-created PscConnection should use as target.

<a name="nested_psc_auto_connections"></a>The `psc_auto_connections` block contains:

* `psc_connection_id` -
  (Output)
  Output only. The PSC connection id of the forwarding rule connected to the
  service attachment.

* `ip_address` -
  (Output)
  Output only. The IP allocated on the consumer network for the PSC forwarding rule.

* `forwarding_rule` -
  (Output)
  Output only. The URI of the consumer side forwarding rule.
  Format:
  projects/{project}/regions/{region}/forwardingRules/{forwarding_rule}

* `project_id` -
  (Output)
  Output only. The consumer project_id where the forwarding rule is created from.

* `network` -
  (Output)
  Output only. The consumer network where the IP address resides, in the form of
  projects/{project_id}/global/networks/{network_id}.

* `service_attachment` -
  (Output)
  Output only. The service attachment which is the target of the PSC connection, in the form of projects/{project-id}/regions/{region}/serviceAttachments/{service-attachment-id}.

* `psc_connection_status` -
  (Output)
  Output Only. The status of the PSC connection: whether a connection exists and ACTIVE or it no longer exists. 
   Possible values:
   ACTIVE 
   NOT_FOUND

* `connection_type` -
  (Output)
  Output Only. Type of a PSC Connection. 
   Possible values:
   CONNECTION_TYPE_DISCOVERY 
   CONNECTION_TYPE_PRIMARY 
   CONNECTION_TYPE_READER

* `port` -
  (Output)
  Output only. Ports of the exposed endpoint.

<a name="nested_managed_server_ca"></a>The `managed_server_ca` block contains:

* `ca_certs` -
  (Output)
  The PEM encoded CA certificate chains for managed server authentication
  Structure is [documented below](#nested_managed_server_ca_ca_certs).


<a name="nested_managed_server_ca_ca_certs"></a>The `ca_certs` block contains:

* `certificates` -
  (Output)
  The certificates that form the CA chain, from leaf to root order

## Timeouts

This resource provides the following
[Timeouts](https://developer.hashicorp.com/terraform/plugin/sdkv2/resources/retries-and-customizable-timeouts) configuration options:

- `create` - Default is 60 minutes.
- `update` - Default is 120 minutes.
- `delete` - Default is 30 minutes.

## Import


Instance can be imported using any of these accepted formats:

* `projects/{{project}}/locations/{{location}}/instances/{{instance_id}}`
* `{{project}}/{{location}}/{{instance_id}}`
* `{{location}}/{{instance_id}}`


In Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import Instance using one of the formats above. For example:

```tf
import {
  id = "projects/{{project}}/locations/{{location}}/instances/{{instance_id}}"
  to = google_memorystore_instance.default
}
```

When using the [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import), Instance can be imported using one of the formats above. For example:

```
$ terraform import google_memorystore_instance.default projects/{{project}}/locations/{{location}}/instances/{{instance_id}}
$ terraform import google_memorystore_instance.default {{project}}/{{location}}/{{instance_id}}
$ terraform import google_memorystore_instance.default {{location}}/{{instance_id}}
```

## User Project Overrides

This resource supports [User Project Overrides](https://registry.terraform.io/providers/hashicorp/google/latest/docs/guides/provider_reference#user_project_override).
