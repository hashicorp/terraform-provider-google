---
# ----------------------------------------------------------------------------
#
#     ***     AUTO GENERATED CODE    ***    Type: MMv1     ***
#
# ----------------------------------------------------------------------------
#
#     This code is generated by Magic Modules using the following:
#
#     Configuration: https:#github.com/GoogleCloudPlatform/magic-modules/tree/main/mmv1/products/ces/Agent.yaml
#     Template:      https:#github.com/GoogleCloudPlatform/magic-modules/tree/main/mmv1/templates/terraform/resource.html.markdown.tmpl
#
#     DO NOT EDIT this file directly. Any changes made to this file will be
#     overwritten during the next generation cycle.
#
# ----------------------------------------------------------------------------
subcategory: "Customer Engagement Suite"
description: |-
  Description
---

# google_ces_agent

Description



<div class = "oics-button" style="float: right; margin: 0 0 -15px">
  <a href="https://console.cloud.google.com/cloudshell/open?cloudshell_git_repo=https%3A%2F%2Fgithub.com%2Fterraform-google-modules%2Fdocs-examples.git&cloudshell_image=gcr.io%2Fcloudshell-images%2Fcloudshell%3Alatest&cloudshell_print=.%2Fmotd&cloudshell_tutorial=.%2Ftutorial.md&cloudshell_working_dir=ces_agent_basic&open_in_editor=main.tf" target="_blank">
    <img alt="Open in Cloud Shell" src="//gstatic.com/cloudssh/images/open-btn.svg" style="max-height: 44px; margin: 32px auto; max-width: 100%;">
  </a>
</div>
## Example Usage - Ces Agent Basic


```hcl
resource "google_ces_app" "ces_app_for_agent" {
  app_id = "app-id"
  location = "us"
  description = "App used as parent for CES Agent example"
  display_name = "my-app"

  language_settings {
    default_language_code    = "en-US"
    supported_language_codes = ["es-ES", "fr-FR"]
    enable_multilingual_support = true
    fallback_action          = "escalate"
  }

  time_zone_settings {
    time_zone = "America/Los_Angeles"
  }
}

resource "google_ces_tool" "ces_tool_for_agent" {
    location       = "us"
    app            = google_ces_app.ces_app_for_agent.app_id
    tool_id        = "tool-1"
    execution_type = "SYNCHRONOUS"
    python_function {
        name = "example_function"
        python_code = "def example_function() -> int: return 0"
    }
}

resource "google_ces_toolset" "ces_toolset_for_agent" {
  toolset_id = "toolset-id"

  location = "us"
  app      = google_ces_app.ces_app_for_agent.app_id
  display_name = "Basic toolset display name"

  open_api_toolset {
    open_api_schema = <<-EOT
      openapi: 3.0.0
      info:
        title: My Sample API
        version: 1.0.0
        description: A simple API example
      servers:
        - url: https://api.example.com/v1
      paths: {}
    EOT
    ignore_unknown_fields = false
    tls_config {
        ca_certs {
          display_name="example"
          cert="ZXhhbXBsZQ=="
        }
    }
    service_directory_config {
      service = "projects/example/locations/us/namespaces/namespace/services/service"
    }
    api_authentication {
        service_agent_id_token_auth_config {
        }
    }
  }
}


resource "google_ces_agent" "ces_child_agent" {
  agent_id = "child-agent-id"
  location = "us"
  app      = google_ces_app.ces_app_for_agent.app_id
  display_name = "child agent"

  instruction = "You are a helpful assistant for this example."

  model_settings {
    model       = "gemini-1.5-flash"
    temperature = 0.5
  }

  llm_agent {
  }
}


resource "google_ces_guardrail" "ces_guardrail_for_agent" {
  guardrail_id = "guardrail-id"
  location     = google_ces_app.ces_app_for_agent.location
  app          = google_ces_app.ces_app_for_agent.app_id
  display_name = "Example guardrail"
  description  = "Guardrail description"
  action {
    respond_immediately  {
        responses {
            text = "Text"
            disabled = false
        }
    }
  }
  enabled = true
  model_safety  {
    safety_settings {
        category = "HARM_CATEGORY_HATE_SPEECH"
        threshold = "BLOCK_NONE"
    }
  }
}




resource "google_ces_agent" "ces_agent_basic" {
  agent_id = "agent-id"
  location = "us"
  app      = google_ces_app.ces_app_for_agent.app_id
  display_name = "my-agent"
  description = "test agent"

  instruction = "You are a helpful assistant for this example."

  model_settings {
    model       = "gemini-1.5-flash"
    temperature = 0.5
  }

  after_agent_callbacks {
    description = "Example callback"
    disabled    = true
    python_code = "def callback(context):\n    return {'override': False}"
  }

  before_agent_callbacks {
    description = "Example callback"
    disabled    = false
    python_code = "def callback(context):\n    return {'override': False}"
  }

  after_model_callbacks {
    description = "Example callback"
    disabled    = true
    python_code = "def callback(context):\n    return {'override': False}"
  }

  before_model_callbacks {
    description = "Example callback"
    disabled    = true
    python_code = "def callback(context):\n    return {'override': False}"
  }

  after_tool_callbacks {
    description = "Example callback"
    disabled    = true
    python_code = "def callback(context):\n    return {'override': False}"
  }

  before_tool_callbacks {
    description = "Example callback"
    disabled    = true
    python_code = "def callback(context):\n    return {'override': False}"
  }

  tools = [
    google_ces_tool.ces_tool_for_agent.id
  ]

  guardrails = [
    google_ces_guardrail.ces_guardrail_for_agent.id
  ]

  toolsets {
    toolset = google_ces_toolset.ces_toolset_for_agent.id
    tool_ids = ["testtoolid"]
  }

  child_agents = ["projects/${google_ces_app.ces_app_for_agent.project}/locations/us/apps/${google_ces_app.ces_app_for_agent.app_id}/agents/${google_ces_agent.ces_child_agent.agent_id}"]

  llm_agent {}
}
```
<div class = "oics-button" style="float: right; margin: 0 0 -15px">
  <a href="https://console.cloud.google.com/cloudshell/open?cloudshell_git_repo=https%3A%2F%2Fgithub.com%2Fterraform-google-modules%2Fdocs-examples.git&cloudshell_image=gcr.io%2Fcloudshell-images%2Fcloudshell%3Alatest&cloudshell_print=.%2Fmotd&cloudshell_tutorial=.%2Ftutorial.md&cloudshell_working_dir=ces_agent_remote_dialogflow_agent&open_in_editor=main.tf" target="_blank">
    <img alt="Open in Cloud Shell" src="//gstatic.com/cloudssh/images/open-btn.svg" style="max-height: 44px; margin: 32px auto; max-width: 100%;">
  </a>
</div>
## Example Usage - Ces Agent Remote Dialogflow Agent


```hcl
resource "google_ces_app" "ces_app_for_agent" {
  app_id = "app-id"
  location = "us"
  description = "App used as parent for CES Agent example"
  display_name = "my-app"

  language_settings {
    default_language_code    = "en-US"
    supported_language_codes = ["es-ES", "fr-FR"]
    enable_multilingual_support = true
    fallback_action          = "escalate"
  }

  time_zone_settings {
    time_zone = "America/Los_Angeles"
  }
}

resource "google_ces_agent" "ces_agent_remote_dialogflow_agent" {
  agent_id = "agent-id"
  location = "us"
  app      = google_ces_app.ces_app_for_agent.app_id
  display_name = "my-agent"

  model_settings {
    model       = "gemini-1.5-flash"
    temperature = 0.5
  }

  remote_dialogflow_agent {
    agent = "projects/example/locations/us/agents/fake-agent"
    flow_id = "fake-flow"
    environment_id = "fake-env"
    input_variable_mapping = {
        "example" : 1
    }
    output_variable_mapping = {
        "example" : 1
    }
  }
}
```

## Argument Reference

The following arguments are supported:


* `display_name` -
  (Required)
  Display name of the agent.

* `location` -
  (Required)
  Resource ID segment making up resource `name`. It identifies the resource within its parent collection as described in https://google.aip.dev/122.

* `app` -
  (Required)
  Resource ID segment making up resource `name`. It identifies the resource within its parent collection as described in https://google.aip.dev/122.


* `after_agent_callbacks` -
  (Optional)
  The callbacks to execute after the agent is called.
  The provided callbacks are executed sequentially in the exact order they
  are given in the list. If a callback returns an overridden response,
  execution stops and any remaining callbacks are skipped.
  Structure is [documented below](#nested_after_agent_callbacks).

* `after_model_callbacks` -
  (Optional)
  The callbacks to execute after the model is called. If there are multiple
  calls to the model, the callback will be executed multiple times.
  The provided callbacks are executed sequentially in the exact order they
  are given in the list. If a callback returns an overridden response,
  execution stops and any remaining callbacks are skipped.
  Structure is [documented below](#nested_after_model_callbacks).

* `after_tool_callbacks` -
  (Optional)
  The callbacks to execute after the tool is invoked. If there are multiple
  tool invocations, the callback will be executed multiple times.
  The provided callbacks are executed sequentially in the exact order they
  are given in the list. If a callback returns an overridden response,
  execution stops and any remaining callbacks are skipped.
  Structure is [documented below](#nested_after_tool_callbacks).

* `before_agent_callbacks` -
  (Optional)
  The callbacks to execute before the agent is called.
  The provided callbacks are executed sequentially in the exact order they
  are given in the list. If a callback returns an overridden response,
  execution stops and any remaining callbacks are skipped.
  Structure is [documented below](#nested_before_agent_callbacks).

* `before_model_callbacks` -
  (Optional)
  The callbacks to execute before the model is called. If there are multiple
  calls to the model, the callback will be executed multiple times.
  The provided callbacks are executed sequentially in the exact order they
  are given in the list. If a callback returns an overridden response,
  execution stops and any remaining callbacks are skipped.
  Structure is [documented below](#nested_before_model_callbacks).

* `before_tool_callbacks` -
  (Optional)
  The callbacks to execute before the tool is invoked. If there are multiple
  tool invocations, the callback will be executed multiple times.
  The provided callbacks are executed sequentially in the exact order they
  are given in the list. If a callback returns an overridden response,
  execution stops and any remaining callbacks are skipped.
  Structure is [documented below](#nested_before_tool_callbacks).

* `child_agents` -
  (Optional)
  List of child agents in the agent tree.
  Format: `projects/{project}/locations/{location}/apps/{app}/agents/{agent}`

* `description` -
  (Optional)
  Human-readable description of the agent.

* `guardrails` -
  (Optional)
  List of guardrails for the agent.
  Format:
  `projects/{project}/locations/{location}/apps/{app}/guardrails/{guardrail}`

* `instruction` -
  (Optional)
  Instructions for the LLM model to guide the agent's behavior.

* `model_settings` -
  (Optional)
  Model settings contains various configurations for the LLM model.
  Structure is [documented below](#nested_model_settings).

* `llm_agent` -
  (Optional)
  Default agent type. The agent uses instructions and callbacks specified in
  the agent to perform the task using a large language model.

* `remote_dialogflow_agent` -
  (Optional)
  The agent which will transfer execution to an existing remote
  [Dialogflow](https://cloud.google.com/dialogflow/cx/docs/concept/console-conversational-agents)
  agent flow. The corresponding Dialogflow agent will process subsequent user
  queries until the session ends or flow ends and the control is transferred
  back to the parent CES agent.
  Structure is [documented below](#nested_remote_dialogflow_agent).

* `tools` -
  (Optional)
  List of available tools for the agent.
  Format: `projects/{project}/locations/{location}/apps/{app}/tools/{tool}`

* `toolsets` -
  (Optional)
  List of toolsets for the agent.
  Structure is [documented below](#nested_toolsets).

* `agent_id` -
  (Optional)
  The ID to use for the agent, which will become the final component of
  the agent's resource name. If not provided, a unique ID will be
  automatically assigned for the agent.

* `project` - (Optional) The ID of the project in which the resource belongs.
    If it is not provided, the provider project is used.



<a name="nested_after_agent_callbacks"></a>The `after_agent_callbacks` block supports:

* `description` -
  (Optional)
  Human-readable description of the callback.

* `disabled` -
  (Optional)
  Whether the callback is disabled. Disabled callbacks are ignored by the
  agent.

* `python_code` -
  (Required)
  The python code to execute for the callback.

<a name="nested_after_model_callbacks"></a>The `after_model_callbacks` block supports:

* `description` -
  (Optional)
  Human-readable description of the callback.

* `disabled` -
  (Optional)
  Whether the callback is disabled. Disabled callbacks are ignored by the
  agent.

* `python_code` -
  (Required)
  The python code to execute for the callback.

<a name="nested_after_tool_callbacks"></a>The `after_tool_callbacks` block supports:

* `description` -
  (Optional)
  Human-readable description of the callback.

* `disabled` -
  (Optional)
  Whether the callback is disabled. Disabled callbacks are ignored by the
  agent.

* `python_code` -
  (Required)
  The python code to execute for the callback.

<a name="nested_before_agent_callbacks"></a>The `before_agent_callbacks` block supports:

* `description` -
  (Optional)
  Human-readable description of the callback.

* `disabled` -
  (Optional)
  Whether the callback is disabled. Disabled callbacks are ignored by the
  agent.

* `python_code` -
  (Required)
  The python code to execute for the callback.

<a name="nested_before_model_callbacks"></a>The `before_model_callbacks` block supports:

* `description` -
  (Optional)
  Human-readable description of the callback.

* `disabled` -
  (Optional)
  Whether the callback is disabled. Disabled callbacks are ignored by the
  agent.

* `python_code` -
  (Required)
  The python code to execute for the callback.

<a name="nested_before_tool_callbacks"></a>The `before_tool_callbacks` block supports:

* `description` -
  (Optional)
  Human-readable description of the callback.

* `disabled` -
  (Optional)
  Whether the callback is disabled. Disabled callbacks are ignored by the
  agent.

* `python_code` -
  (Required)
  The python code to execute for the callback.

<a name="nested_model_settings"></a>The `model_settings` block supports:

* `model` -
  (Optional)
  The LLM model that the agent should use.
  If not set, the agent will inherit the model from its parent agent.

* `temperature` -
  (Optional)
  If set, this temperature will be used for the LLM model. Temperature
  controls the randomness of the model's responses. Lower temperatures
  produce responses that are more predictable. Higher temperatures produce
  responses that are more creative.

<a name="nested_remote_dialogflow_agent"></a>The `remote_dialogflow_agent` block supports:

* `agent` -
  (Required)
  The
  [Dialogflow](https://cloud.google.com/dialogflow/cx/docs/concept/console-conversational-agents
  agent resource name.
  Format: `projects/{project}/locations/{location}/agents/{agent}`

* `environment_id` -
  (Optional)
  The environment ID of the Dialogflow agent be used for the agent
  execution. If not specified, the draft environment will be used.

* `flow_id` -
  (Required)
  The flow ID of the flow in the Dialogflow agent.

* `input_variable_mapping` -
  (Optional)
  The mapping of the app variables names to the Dialogflow session
  parameters names to be sent to the Dialogflow agent as input.

* `output_variable_mapping` -
  (Optional)
  The mapping of the Dialogflow session parameters names to the app
  variables names to be sent back to the CES agent after the Dialogflow
  agent execution ends.

<a name="nested_toolsets"></a>The `toolsets` block supports:

* `toolset` -
  (Required)
  The resource name of the toolset.
  Format:
  `projects/{project}/locations/{location}/apps/{app}/toolsets/{toolset}`

* `tool_ids` -
  (Optional)
  The tools IDs to filter the toolset.

## Attributes Reference

In addition to the arguments listed above, the following computed attributes are exported:

* `id` - an identifier for the resource with format `projects/{{project}}/locations/{{location}}/apps/{{app}}/agents/{{name}}`

* `create_time` -
  Timestamp when the agent was created.

* `etag` -
  Etag used to ensure the object hasn't changed during a read-modify-write
  operation. If the etag is empty, the update will overwrite any concurrent
  changes.

* `generated_summary` -
  If the agent is generated by the LLM assistant, this field contains a
  descriptive summary of the generation.

* `name` -
  Identifier. The unique identifier of the agent.
  Format: `projects/{project}/locations/{location}/apps/{app}/agents/{agent}`

* `update_time` -
  Timestamp when the agent was last updated.


## Timeouts

This resource provides the following
[Timeouts](https://developer.hashicorp.com/terraform/plugin/sdkv2/resources/retries-and-customizable-timeouts) configuration options:

- `create` - Default is 20 minutes.
- `update` - Default is 20 minutes.
- `delete` - Default is 20 minutes.

## Import


Agent can be imported using any of these accepted formats:

* `projects/{{project}}/locations/{{location}}/apps/{{app}}/agents/{{name}}`
* `{{project}}/{{location}}/{{app}}/{{name}}`
* `{{location}}/{{app}}/{{name}}`

In Terraform v1.12.0 and later, use an [`identity` block](https://developer.hashicorp.com/terraform/language/resources/identities) to import Agent using identity values. For example:

```tf
import {
  identity = {
    name = "<-optional value->"
    location = "<-required value->"
    app = "<-required value->"
    project = "<-optional value->"
  }
  to = google_ces_agent.default
}
```

In Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import Agent using one of the formats above. For example:

```tf
import {
  id = "projects/{{project}}/locations/{{location}}/apps/{{app}}/agents/{{name}}"
  to = google_ces_agent.default
}
```

When using the [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import), Agent can be imported using one of the formats above. For example:

```
$ terraform import google_ces_agent.default projects/{{project}}/locations/{{location}}/apps/{{app}}/agents/{{name}}
$ terraform import google_ces_agent.default {{project}}/{{location}}/{{app}}/{{name}}
$ terraform import google_ces_agent.default {{location}}/{{app}}/{{name}}
```

## User Project Overrides

This resource supports [User Project Overrides](https://registry.terraform.io/providers/hashicorp/google/latest/docs/guides/provider_reference#user_project_override).
